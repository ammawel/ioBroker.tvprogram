"use strict";(()=>{var Te=(t,e)=>()=>(t&&(e=t(t=0)),e);var ke=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var R=(t,e,n)=>new Promise((o,i)=>{var a=h=>{try{c(n.next(h))}catch(u){i(u)}},l=h=>{try{c(n.throw(h))}catch(u){i(u)}},c=h=>h.done?o(h.value):Promise.resolve(h.value).then(a,l);c((n=n.apply(t,e)).next())});var Ee,Ae=Te(()=>{Ee="2.1.0"});function _e(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,o)}return n}function ht(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?_e(Object(n),!0).forEach(function(o){on(t,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_e(Object(n)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(n,o))})}return t}function Xt(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Xt=function(e){return typeof e}:Xt=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xt(t)}function on(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ft(){return ft=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},ft.apply(this,arguments)}function rn(t,e){if(t==null)return{};var n={},o=Object.keys(t),i,a;for(a=0;a<o.length;a++)i=o[a],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function an(t,e){if(t==null)return{};var n=rn(t,e),o,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(i=0;i<a.length;i++)o=a[i],!(e.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(t,o)&&(n[o]=t[o])}return n}function ut(t){if(typeof window!="undefined"&&window.navigator)return!!navigator.userAgent.match(t)}function P(t,e,n){t.addEventListener(e,n,!pt&&je)}function N(t,e,n){t.removeEventListener(e,n,!pt&&je)}function It(t,e){if(e){if(e[0]===">"&&(e=e.substring(1)),t)try{if(t.matches)return t.matches(e);if(t.msMatchesSelector)return t.msMatchesSelector(e);if(t.webkitMatchesSelector)return t.webkitMatchesSelector(e)}catch(n){return!1}return!1}}function We(t){return t.host&&t!==document&&t.host.nodeType?t.host:t.parentNode}function ct(t,e,n,o){if(t){n=n||document;do{if(e!=null&&(e[0]===">"?t.parentNode===n&&It(t,e):It(t,e))||o&&t===n)return t;if(t===n)break}while(t=We(t))}return null}function it(t,e,n){if(t&&e)if(t.classList)t.classList[n?"add":"remove"](e);else{var o=(" "+t.className+" ").replace(Oe," ").replace(" "+e+" "," ");t.className=(o+(n?" "+e:"")).replace(Oe," ")}}function E(t,e,n){var o=t&&t.style;if(o){if(n===void 0)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(t,""):t.currentStyle&&(n=t.currentStyle),e===void 0?n:n[e];!(e in o)&&e.indexOf("webkit")===-1&&(e="-webkit-"+e),o[e]=n+(typeof n=="string"?"":"px")}}function _t(t,e){var n="";if(typeof t=="string")n=t;else do{var o=E(t,"transform");o&&o!=="none"&&(n=o+" "+n)}while(!e&&(t=t.parentNode));var i=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return i&&new i(n)}function Re(t,e,n){if(t){var o=t.getElementsByTagName(e),i=0,a=o.length;if(n)for(;i<a;i++)n(o[i],i);return o}return[]}function dt(){var t=document.scrollingElement;return t||document.documentElement}function X(t,e,n,o,i){if(!(!t.getBoundingClientRect&&t!==window)){var a,l,c,h,u,p,f;if(t!==window&&t.parentNode&&t!==dt()?(a=t.getBoundingClientRect(),l=a.top,c=a.left,h=a.bottom,u=a.right,p=a.height,f=a.width):(l=0,c=0,h=window.innerHeight,u=window.innerWidth,p=window.innerHeight,f=window.innerWidth),(e||n)&&t!==window&&(i=i||t.parentNode,!pt))do if(i&&i.getBoundingClientRect&&(E(i,"transform")!=="none"||n&&E(i,"position")!=="static")){var b=i.getBoundingClientRect();l-=b.top+parseInt(E(i,"border-top-width")),c-=b.left+parseInt(E(i,"border-left-width")),h=l+a.height,u=c+a.width;break}while(i=i.parentNode);if(o&&t!==window){var w=_t(i||t),g=w&&w.a,S=w&&w.d;w&&(l/=S,c/=g,f/=g,p/=S,h=l+p,u=c+f)}return{top:l,left:c,bottom:h,right:u,width:f,height:p}}}function He(t,e,n){for(var o=bt(t,!0),i=X(t)[e];o;){var a=X(o)[n],l=void 0;if(n==="top"||n==="left"?l=i>=a:l=i<=a,!l)return o;if(o===dt())break;o=bt(o,!1)}return!1}function Mt(t,e,n,o){for(var i=0,a=0,l=t.children;a<l.length;){if(l[a].style.display!=="none"&&l[a]!==_.ghost&&(o||l[a]!==_.dragged)&&ct(l[a],n.draggable,t,!1)){if(i===e)return l[a];i++}a++}return null}function ye(t,e){for(var n=t.lastElementChild;n&&(n===_.ghost||E(n,"display")==="none"||e&&!It(n,e));)n=n.previousElementSibling;return n||null}function st(t,e){var n=0;if(!t||!t.parentNode)return-1;for(;t=t.previousElementSibling;)t.nodeName.toUpperCase()!=="TEMPLATE"&&t!==_.clone&&(!e||It(t,e))&&n++;return n}function Ve(t){var e=0,n=0,o=dt();if(t)do{var i=_t(t),a=i.a,l=i.d;e+=t.scrollLeft*a,n+=t.scrollTop*l}while(t!==o&&(t=t.parentNode));return[e,n]}function ln(t,e){for(var n in t)if(t.hasOwnProperty(n)){for(var o in e)if(e.hasOwnProperty(o)&&e[o]===t[n][o])return Number(n)}return-1}function bt(t,e){if(!t||!t.getBoundingClientRect)return dt();var n=t,o=!1;do if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){var i=E(n);if(n.clientWidth<n.scrollWidth&&(i.overflowX=="auto"||i.overflowX=="scroll")||n.clientHeight<n.scrollHeight&&(i.overflowY=="auto"||i.overflowY=="scroll")){if(!n.getBoundingClientRect||n===document.body)return dt();if(o||e)return n;o=!0}}while(n=n.parentNode);return dt()}function cn(t,e){if(t&&e)for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function ae(t,e){return Math.round(t.top)===Math.round(e.top)&&Math.round(t.left)===Math.round(e.left)&&Math.round(t.height)===Math.round(e.height)&&Math.round(t.width)===Math.round(e.width)}function ze(t,e){return function(){if(!Bt){var n=arguments,o=this;n.length===1?t.call(o,n[0]):t.apply(o,n),Bt=setTimeout(function(){Bt=void 0},e)}}}function dn(){clearTimeout(Bt),Bt=void 0}function Ye(t,e,n){t.scrollLeft+=e,t.scrollTop+=n}function De(t){var e=window.Polymer,n=window.jQuery||window.Zepto;return e&&e.dom?e.dom(t).cloneNode(!0):n?n(t).clone(!0)[0]:t.cloneNode(!0)}function qe(t,e,n){var o={};return Array.from(t.children).forEach(function(i){var a,l,c,h;if(!(!ct(i,e.draggable,t,!1)||i.animated||i===n)){var u=X(i);o.left=Math.min((a=o.left)!==null&&a!==void 0?a:1/0,u.left),o.top=Math.min((l=o.top)!==null&&l!==void 0?l:1/0,u.top),o.right=Math.max((c=o.right)!==null&&c!==void 0?c:-1/0,u.right),o.bottom=Math.max((h=o.bottom)!==null&&h!==void 0?h:-1/0,u.bottom)}}),o.width=o.right-o.left,o.height=o.bottom-o.top,o.x=o.left,o.y=o.top,o}function hn(){var t=[],e;return{captureAnimationState:function(){if(t=[],!!this.options.animation){var o=[].slice.call(this.el.children);o.forEach(function(i){if(!(E(i,"display")==="none"||i===_.ghost)){t.push({target:i,rect:X(i)});var a=ht({},t[t.length-1].rect);if(i.thisAnimationDuration){var l=_t(i,!0);l&&(a.top-=l.f,a.left-=l.e)}i.fromRect=a}})}},addAnimationState:function(o){t.push(o)},removeAnimationState:function(o){t.splice(ln(t,{target:o}),1)},animateAll:function(o){var i=this;if(!this.options.animation){clearTimeout(e),typeof o=="function"&&o();return}var a=!1,l=0;t.forEach(function(c){var h=0,u=c.target,p=u.fromRect,f=X(u),b=u.prevFromRect,w=u.prevToRect,g=c.rect,S=_t(u,!0);S&&(f.top-=S.f,f.left-=S.e),u.toRect=f,u.thisAnimationDuration&&ae(b,f)&&!ae(p,f)&&(g.top-f.top)/(g.left-f.left)===(p.top-f.top)/(p.left-f.left)&&(h=fn(g,b,w,i.options)),ae(f,p)||(u.prevFromRect=p,u.prevToRect=f,h||(h=i.options.animation),i.animate(u,g,f,h)),h&&(a=!0,l=Math.max(l,h),clearTimeout(u.animationResetTimer),u.animationResetTimer=setTimeout(function(){u.animationTime=0,u.prevFromRect=null,u.fromRect=null,u.prevToRect=null,u.thisAnimationDuration=null},h),u.thisAnimationDuration=h)}),clearTimeout(e),a?e=setTimeout(function(){typeof o=="function"&&o()},l):typeof o=="function"&&o(),t=[]},animate:function(o,i,a,l){if(l){E(o,"transition",""),E(o,"transform","");var c=_t(this.el),h=c&&c.a,u=c&&c.d,p=(i.left-a.left)/(h||1),f=(i.top-a.top)/(u||1);o.animatingX=!!p,o.animatingY=!!f,E(o,"transform","translate3d("+p+"px,"+f+"px,0)"),this.forRepaintDummy=un(o),E(o,"transition","transform "+l+"ms"+(this.options.easing?" "+this.options.easing:"")),E(o,"transform","translate3d(0,0,0)"),typeof o.animated=="number"&&clearTimeout(o.animated),o.animated=setTimeout(function(){E(o,"transition",""),E(o,"transform",""),o.animated=!1,o.animatingX=!1,o.animatingY=!1},l)}}}}function un(t){return t.offsetWidth}function fn(t,e,n,o){return Math.sqrt(Math.pow(e.top-t.top,2)+Math.pow(e.left-t.left,2))/Math.sqrt(Math.pow(e.top-n.top,2)+Math.pow(e.left-n.left,2))*o.animation}function pn(t){var e=t.sortable,n=t.rootEl,o=t.name,i=t.targetEl,a=t.cloneEl,l=t.toEl,c=t.fromEl,h=t.oldIndex,u=t.newIndex,p=t.oldDraggableIndex,f=t.newDraggableIndex,b=t.originalEvent,w=t.putSortable,g=t.extraEventProperties;if(e=e||n&&n[ot],!!e){var S,s=e.options,d="on"+o.charAt(0).toUpperCase()+o.substr(1);window.CustomEvent&&!pt&&!Rt?S=new CustomEvent(o,{bubbles:!0,cancelable:!0}):(S=document.createEvent("Event"),S.initEvent(o,!0,!0)),S.to=l||n,S.from=c||n,S.item=i||n,S.clone=a,S.oldIndex=h,S.newIndex=u,S.oldDraggableIndex=p,S.newDraggableIndex=f,S.originalEvent=b,S.pullMode=w?w.lastPutMode:void 0;var V=ht(ht({},g),zt.getEventProperties(o,e));for(var L in V)S[L]=V[L];n&&n.dispatchEvent(S),s[d]&&s[d].call(e,S)}}function tt(t){pn(ht({putSortable:Q,cloneEl:Y,targetEl:m,rootEl:z,oldIndex:Et,oldDraggableIndex:Ft,newIndex:rt,newDraggableIndex:vt},t))}function _(t,e){if(!(t&&t.nodeType&&t.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(t));this.el=t,this.options=e=ft({},e),t[ot]=this;var n={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(t.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Ge(t,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(l,c){l.setData("Text",c.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:_.supportPointer!==!1&&"PointerEvent"in window&&(!Pt||$e),emptyInsertThreshold:5};zt.initializePlugins(this,t,n);for(var o in n)!(o in e)&&(e[o]=n[o]);Xe(e);for(var i in this)i.charAt(0)==="_"&&typeof this[i]=="function"&&(this[i]=this[i].bind(this));this.nativeDraggable=e.forceFallback?!1:vn,this.nativeDraggable&&(this.options.touchStartThreshold=1),e.supportPointer?P(t,"pointerdown",this._onTapStart):(P(t,"mousedown",this._onTapStart),P(t,"touchstart",this._onTapStart)),this.nativeDraggable&&(P(t,"dragover",this),P(t,"dragenter",this)),ee.push(this.el),e.store&&e.store.get&&this.sort(e.store.get(this)||[]),ft(this,hn())}function yn(t){t.dataTransfer&&(t.dataTransfer.dropEffect="move"),t.cancelable&&t.preventDefault()}function Gt(t,e,n,o,i,a,l,c){var h,u=t[ot],p=u.options.onMove,f;return window.CustomEvent&&!pt&&!Rt?h=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(h=document.createEvent("Event"),h.initEvent("move",!0,!0)),h.to=e,h.from=t,h.dragged=n,h.draggedRect=o,h.related=i||e,h.relatedRect=a||X(e),h.willInsertAfter=c,h.originalEvent=l,t.dispatchEvent(h),p&&(f=p.call(u,h,l)),f}function he(t){t.draggable=!1}function Sn(){ge=!1}function xn(t,e,n){var o=X(Mt(n.el,0,n.options,!0)),i=qe(n.el,n.options,H),a=10;return e?t.clientX<i.left-a||t.clientY<o.top&&t.clientX<o.right:t.clientY<i.top-a||t.clientY<o.bottom&&t.clientX<o.left}function Cn(t,e,n){var o=X(ye(n.el,n.options.draggable)),i=qe(n.el,n.options,H),a=10;return e?t.clientX>i.right+a||t.clientY>o.bottom&&t.clientX>o.left:t.clientY>i.bottom+a||t.clientX>o.right&&t.clientY>o.top}function wn(t,e,n,o,i,a,l,c){var h=o?t.clientY:t.clientX,u=o?n.height:n.width,p=o?n.top:n.left,f=o?n.bottom:n.right,b=!1;if(!l){if(c&&Ut<u*i){if(!Wt&&(jt===1?h>p+u*a/2:h<f-u*a/2)&&(Wt=!0),Wt)b=!0;else if(jt===1?h<p+Ut:h>f-Ut)return-jt}else if(h>p+u*(1-i)/2&&h<f-u*(1-i)/2)return Tn(e)}return b=b||l,b&&(h<p+u*a/2||h>f-u*a/2)?h>p+u/2?1:-1:0}function Tn(t){return st(m)<st(t)?1:-1}function kn(t){for(var e=t.tagName+t.className+t.src+t.href+t.textContent,n=e.length,o=0;n--;)o+=e.charCodeAt(n);return o.toString(36)}function An(t){ne.length=0;for(var e=t.getElementsByTagName("input"),n=e.length;n--;){var o=e[n];o.checked&&ne.push(o)}}function Jt(t){return setTimeout(t,0)}function ve(t){return clearTimeout(t)}function En(){function t(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var e in this)e.charAt(0)==="_"&&typeof this[e]=="function"&&(this[e]=this[e].bind(this))}return t.prototype={dragStarted:function(n){var o=n.originalEvent;this.sortable.nativeDraggable?P(document,"dragover",this._handleAutoScroll):this.options.supportPointer?P(document,"pointermove",this._handleFallbackAutoScroll):o.touches?P(document,"touchmove",this._handleFallbackAutoScroll):P(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(n){var o=n.originalEvent;!this.options.dragOverBubble&&!o.rootEl&&this._handleAutoScroll(o)},drop:function(){this.sortable.nativeDraggable?N(document,"dragover",this._handleAutoScroll):(N(document,"pointermove",this._handleFallbackAutoScroll),N(document,"touchmove",this._handleFallbackAutoScroll),N(document,"mousemove",this._handleFallbackAutoScroll)),Be(),Qt(),dn()},nulling:function(){oe=me=Lt=be=Nt=ue=fe=null,G.length=0},_handleFallbackAutoScroll:function(n){this._handleAutoScroll(n,!0)},_handleAutoScroll:function(n,o){var i=this,a=(n.touches?n.touches[0]:n).clientX,l=(n.touches?n.touches[0]:n).clientY,c=document.elementFromPoint(a,l);if(oe=n,o||this.options.forceAutoScrollFallback||Rt||pt||Pt){pe(n,this.options,c,o);var h=bt(c,!0);be&&(!Nt||a!==ue||l!==fe)&&(Nt&&Be(),Nt=setInterval(function(){var u=bt(document.elementFromPoint(a,l),!0);u!==h&&(h=u,Qt()),pe(n,i.options,u,o)},10),ue=a,fe=l)}else{if(!this.options.bubbleScroll||bt(c,!0)===dt()){Qt();return}pe(n,this.options,bt(c,!1),!1)}}},ft(t,{pluginName:"scroll",initializeByDefault:!0})}function Qt(){G.forEach(function(t){clearInterval(t.pid)}),G=[]}function Be(){clearInterval(Nt)}function Se(){}function xe(){}var sn,pt,Rt,Me,Pt,$e,Fe,je,Oe,Bt,ot,Tt,se,zt,gn,nt,m,q,H,z,Ct,Kt,Y,mt,Et,rt,Ft,vt,Dt,Q,At,te,ee,St,lt,le,ce,Le,Ne,Vt,kt,jt,Wt,qt,Ut,I,de,ge,ne,ie,Zt,Pe,vn,Ze,Ge,mn,bn,Xe,Ke,Ue,xt,$n,G,Lt,me,be,ue,fe,oe,Nt,pe,Je,Qe,Ie=Te(()=>{sn="1.15.6";pt=ut(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),Rt=ut(/Edge/i),Me=ut(/firefox/i),Pt=ut(/safari/i)&&!ut(/chrome/i)&&!ut(/android/i),$e=ut(/iP(ad|od|hone)/i),Fe=ut(/chrome/i)&&ut(/android/i),je={capture:!1,passive:!1};Oe=/\s+/g;ot="Sortable"+new Date().getTime();Tt=[],se={initializeByDefault:!0},zt={mount:function(e){for(var n in se)se.hasOwnProperty(n)&&!(n in e)&&(e[n]=se[n]);Tt.forEach(function(o){if(o.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")}),Tt.push(e)},pluginEvent:function(e,n,o){var i=this;this.eventCanceled=!1,o.cancel=function(){i.eventCanceled=!0};var a=e+"Global";Tt.forEach(function(l){n[l.pluginName]&&(n[l.pluginName][a]&&n[l.pluginName][a](ht({sortable:n},o)),n.options[l.pluginName]&&n[l.pluginName][e]&&n[l.pluginName][e](ht({sortable:n},o)))})},initializePlugins:function(e,n,o,i){Tt.forEach(function(c){var h=c.pluginName;if(!(!e.options[h]&&!c.initializeByDefault)){var u=new c(e,n,e.options);u.sortable=e,u.options=e.options,e[h]=u,ft(o,u.defaults)}});for(var a in e.options)if(e.options.hasOwnProperty(a)){var l=this.modifyOption(e,a,e.options[a]);typeof l!="undefined"&&(e.options[a]=l)}},getEventProperties:function(e,n){var o={};return Tt.forEach(function(i){typeof i.eventProperties=="function"&&ft(o,i.eventProperties.call(n[i.pluginName],e))}),o},modifyOption:function(e,n,o){var i;return Tt.forEach(function(a){e[a.pluginName]&&a.optionListeners&&typeof a.optionListeners[n]=="function"&&(i=a.optionListeners[n].call(e[a.pluginName],o))}),i}};gn=["evt"],nt=function(e,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=o.evt,a=an(o,gn);zt.pluginEvent.bind(_)(e,n,ht({dragEl:m,parentEl:q,ghostEl:H,rootEl:z,nextEl:Ct,lastDownEl:Kt,cloneEl:Y,cloneHidden:mt,dragStarted:Vt,putSortable:Q,activeSortable:_.active,originalEvent:i,oldIndex:Et,oldDraggableIndex:Ft,newIndex:rt,newDraggableIndex:vt,hideGhostForTarget:Ke,unhideGhostForTarget:Ue,cloneNowHidden:function(){mt=!0},cloneNowShown:function(){mt=!1},dispatchSortableEvent:function(c){tt({sortable:n,name:c,originalEvent:i})}},a))};At=!1,te=!1,ee=[],Wt=!1,qt=!1,de=[],ge=!1,ne=[],ie=typeof document!="undefined",Zt=$e,Pe=Rt||pt?"cssFloat":"float",vn=ie&&!Fe&&!$e&&"draggable"in document.createElement("div"),Ze=function(){if(ie){if(pt)return!1;var t=document.createElement("x");return t.style.cssText="pointer-events:auto",t.style.pointerEvents==="auto"}}(),Ge=function(e,n){var o=E(e),i=parseInt(o.width)-parseInt(o.paddingLeft)-parseInt(o.paddingRight)-parseInt(o.borderLeftWidth)-parseInt(o.borderRightWidth),a=Mt(e,0,n),l=Mt(e,1,n),c=a&&E(a),h=l&&E(l),u=c&&parseInt(c.marginLeft)+parseInt(c.marginRight)+X(a).width,p=h&&parseInt(h.marginLeft)+parseInt(h.marginRight)+X(l).width;if(o.display==="flex")return o.flexDirection==="column"||o.flexDirection==="column-reverse"?"vertical":"horizontal";if(o.display==="grid")return o.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(a&&c.float&&c.float!=="none"){var f=c.float==="left"?"left":"right";return l&&(h.clear==="both"||h.clear===f)?"vertical":"horizontal"}return a&&(c.display==="block"||c.display==="flex"||c.display==="table"||c.display==="grid"||u>=i&&o[Pe]==="none"||l&&o[Pe]==="none"&&u+p>i)?"vertical":"horizontal"},mn=function(e,n,o){var i=o?e.left:e.top,a=o?e.right:e.bottom,l=o?e.width:e.height,c=o?n.left:n.top,h=o?n.right:n.bottom,u=o?n.width:n.height;return i===c||a===h||i+l/2===c+u/2},bn=function(e,n){var o;return ee.some(function(i){var a=i[ot].options.emptyInsertThreshold;if(!(!a||ye(i))){var l=X(i),c=e>=l.left-a&&e<=l.right+a,h=n>=l.top-a&&n<=l.bottom+a;if(c&&h)return o=i}}),o},Xe=function(e){function n(a,l){return function(c,h,u,p){var f=c.options.group.name&&h.options.group.name&&c.options.group.name===h.options.group.name;if(a==null&&(l||f))return!0;if(a==null||a===!1)return!1;if(l&&a==="clone")return a;if(typeof a=="function")return n(a(c,h,u,p),l)(c,h,u,p);var b=(l?c:h).options.group.name;return a===!0||typeof a=="string"&&a===b||a.join&&a.indexOf(b)>-1}}var o={},i=e.group;(!i||Xt(i)!="object")&&(i={name:i}),o.name=i.name,o.checkPull=n(i.pull,!0),o.checkPut=n(i.put),o.revertClone=i.revertClone,e.group=o},Ke=function(){!Ze&&H&&E(H,"display","none")},Ue=function(){!Ze&&H&&E(H,"display","")};ie&&!Fe&&document.addEventListener("click",function(t){if(te)return t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.stopImmediatePropagation&&t.stopImmediatePropagation(),te=!1,!1},!0);xt=function(e){if(m){e=e.touches?e.touches[0]:e;var n=bn(e.clientX,e.clientY);if(n){var o={};for(var i in e)e.hasOwnProperty(i)&&(o[i]=e[i]);o.target=o.rootEl=n,o.preventDefault=void 0,o.stopPropagation=void 0,n[ot]._onDragOver(o)}}},$n=function(e){m&&m.parentNode[ot]._isOutsideThisEl(e.target)};_.prototype={constructor:_,_isOutsideThisEl:function(e){!this.el.contains(e)&&e!==this.el&&(kt=null)},_getDirection:function(e,n){return typeof this.options.direction=="function"?this.options.direction.call(this,e,n,m):this.options.direction},_onTapStart:function(e){if(e.cancelable){var n=this,o=this.el,i=this.options,a=i.preventOnFilter,l=e.type,c=e.touches&&e.touches[0]||e.pointerType&&e.pointerType==="touch"&&e,h=(c||e).target,u=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||h,p=i.filter;if(An(o),!m&&!(/mousedown|pointerdown/.test(l)&&e.button!==0||i.disabled)&&!u.isContentEditable&&!(!this.nativeDraggable&&Pt&&h&&h.tagName.toUpperCase()==="SELECT")&&(h=ct(h,i.draggable,o,!1),!(h&&h.animated)&&Kt!==h)){if(Et=st(h),Ft=st(h,i.draggable),typeof p=="function"){if(p.call(this,e,h,this)){tt({sortable:n,rootEl:u,name:"filter",targetEl:h,toEl:o,fromEl:o}),nt("filter",n,{evt:e}),a&&e.preventDefault();return}}else if(p&&(p=p.split(",").some(function(f){if(f=ct(u,f.trim(),o,!1),f)return tt({sortable:n,rootEl:f,name:"filter",targetEl:h,fromEl:o,toEl:o}),nt("filter",n,{evt:e}),!0}),p)){a&&e.preventDefault();return}i.handle&&!ct(u,i.handle,o,!1)||this._prepareDragStart(e,c,h)}}},_prepareDragStart:function(e,n,o){var i=this,a=i.el,l=i.options,c=a.ownerDocument,h;if(o&&!m&&o.parentNode===a){var u=X(o);if(z=a,m=o,q=m.parentNode,Ct=m.nextSibling,Kt=o,Dt=l.group,_.dragged=m,St={target:m,clientX:(n||e).clientX,clientY:(n||e).clientY},Le=St.clientX-u.left,Ne=St.clientY-u.top,this._lastX=(n||e).clientX,this._lastY=(n||e).clientY,m.style["will-change"]="all",h=function(){if(nt("delayEnded",i,{evt:e}),_.eventCanceled){i._onDrop();return}i._disableDelayedDragEvents(),!Me&&i.nativeDraggable&&(m.draggable=!0),i._triggerDragStart(e,n),tt({sortable:i,name:"choose",originalEvent:e}),it(m,l.chosenClass,!0)},l.ignore.split(",").forEach(function(p){Re(m,p.trim(),he)}),P(c,"dragover",xt),P(c,"mousemove",xt),P(c,"touchmove",xt),l.supportPointer?(P(c,"pointerup",i._onDrop),!this.nativeDraggable&&P(c,"pointercancel",i._onDrop)):(P(c,"mouseup",i._onDrop),P(c,"touchend",i._onDrop),P(c,"touchcancel",i._onDrop)),Me&&this.nativeDraggable&&(this.options.touchStartThreshold=4,m.draggable=!0),nt("delayStart",this,{evt:e}),l.delay&&(!l.delayOnTouchOnly||n)&&(!this.nativeDraggable||!(Rt||pt))){if(_.eventCanceled){this._onDrop();return}l.supportPointer?(P(c,"pointerup",i._disableDelayedDrag),P(c,"pointercancel",i._disableDelayedDrag)):(P(c,"mouseup",i._disableDelayedDrag),P(c,"touchend",i._disableDelayedDrag),P(c,"touchcancel",i._disableDelayedDrag)),P(c,"mousemove",i._delayedDragTouchMoveHandler),P(c,"touchmove",i._delayedDragTouchMoveHandler),l.supportPointer&&P(c,"pointermove",i._delayedDragTouchMoveHandler),i._dragStartTimer=setTimeout(h,l.delay)}else h()}},_delayedDragTouchMoveHandler:function(e){var n=e.touches?e.touches[0]:e;Math.max(Math.abs(n.clientX-this._lastX),Math.abs(n.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){m&&he(m),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;N(e,"mouseup",this._disableDelayedDrag),N(e,"touchend",this._disableDelayedDrag),N(e,"touchcancel",this._disableDelayedDrag),N(e,"pointerup",this._disableDelayedDrag),N(e,"pointercancel",this._disableDelayedDrag),N(e,"mousemove",this._delayedDragTouchMoveHandler),N(e,"touchmove",this._delayedDragTouchMoveHandler),N(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,n){n=n||e.pointerType=="touch"&&e,!this.nativeDraggable||n?this.options.supportPointer?P(document,"pointermove",this._onTouchMove):n?P(document,"touchmove",this._onTouchMove):P(document,"mousemove",this._onTouchMove):(P(m,"dragend",this),P(z,"dragstart",this._onDragStart));try{document.selection?Jt(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch(o){}},_dragStarted:function(e,n){if(At=!1,z&&m){nt("dragStarted",this,{evt:n}),this.nativeDraggable&&P(document,"dragover",$n);var o=this.options;!e&&it(m,o.dragClass,!1),it(m,o.ghostClass,!0),_.active=this,e&&this._appendGhost(),tt({sortable:this,name:"start",originalEvent:n})}else this._nulling()},_emulateDragOver:function(){if(lt){this._lastX=lt.clientX,this._lastY=lt.clientY,Ke();for(var e=document.elementFromPoint(lt.clientX,lt.clientY),n=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(lt.clientX,lt.clientY),e!==n);)n=e;if(m.parentNode[ot]._isOutsideThisEl(e),n)do{if(n[ot]){var o=void 0;if(o=n[ot]._onDragOver({clientX:lt.clientX,clientY:lt.clientY,target:e,rootEl:n}),o&&!this.options.dragoverBubble)break}e=n}while(n=We(n));Ue()}},_onTouchMove:function(e){if(St){var n=this.options,o=n.fallbackTolerance,i=n.fallbackOffset,a=e.touches?e.touches[0]:e,l=H&&_t(H,!0),c=H&&l&&l.a,h=H&&l&&l.d,u=Zt&&I&&Ve(I),p=(a.clientX-St.clientX+i.x)/(c||1)+(u?u[0]-de[0]:0)/(c||1),f=(a.clientY-St.clientY+i.y)/(h||1)+(u?u[1]-de[1]:0)/(h||1);if(!_.active&&!At){if(o&&Math.max(Math.abs(a.clientX-this._lastX),Math.abs(a.clientY-this._lastY))<o)return;this._onDragStart(e,!0)}if(H){l?(l.e+=p-(le||0),l.f+=f-(ce||0)):l={a:1,b:0,c:0,d:1,e:p,f};var b="matrix(".concat(l.a,",").concat(l.b,",").concat(l.c,",").concat(l.d,",").concat(l.e,",").concat(l.f,")");E(H,"webkitTransform",b),E(H,"mozTransform",b),E(H,"msTransform",b),E(H,"transform",b),le=p,ce=f,lt=a}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!H){var e=this.options.fallbackOnBody?document.body:z,n=X(m,!0,Zt,!0,e),o=this.options;if(Zt){for(I=e;E(I,"position")==="static"&&E(I,"transform")==="none"&&I!==document;)I=I.parentNode;I!==document.body&&I!==document.documentElement?(I===document&&(I=dt()),n.top+=I.scrollTop,n.left+=I.scrollLeft):I=dt(),de=Ve(I)}H=m.cloneNode(!0),it(H,o.ghostClass,!1),it(H,o.fallbackClass,!0),it(H,o.dragClass,!0),E(H,"transition",""),E(H,"transform",""),E(H,"box-sizing","border-box"),E(H,"margin",0),E(H,"top",n.top),E(H,"left",n.left),E(H,"width",n.width),E(H,"height",n.height),E(H,"opacity","0.8"),E(H,"position",Zt?"absolute":"fixed"),E(H,"zIndex","100000"),E(H,"pointerEvents","none"),_.ghost=H,e.appendChild(H),E(H,"transform-origin",Le/parseInt(H.style.width)*100+"% "+Ne/parseInt(H.style.height)*100+"%")}},_onDragStart:function(e,n){var o=this,i=e.dataTransfer,a=o.options;if(nt("dragStart",this,{evt:e}),_.eventCanceled){this._onDrop();return}nt("setupClone",this),_.eventCanceled||(Y=De(m),Y.removeAttribute("id"),Y.draggable=!1,Y.style["will-change"]="",this._hideClone(),it(Y,this.options.chosenClass,!1),_.clone=Y),o.cloneId=Jt(function(){nt("clone",o),!_.eventCanceled&&(o.options.removeCloneOnHide||z.insertBefore(Y,m),o._hideClone(),tt({sortable:o,name:"clone"}))}),!n&&it(m,a.dragClass,!0),n?(te=!0,o._loopId=setInterval(o._emulateDragOver,50)):(N(document,"mouseup",o._onDrop),N(document,"touchend",o._onDrop),N(document,"touchcancel",o._onDrop),i&&(i.effectAllowed="move",a.setData&&a.setData.call(o,i,m)),P(document,"drop",o),E(m,"transform","translateZ(0)")),At=!0,o._dragStartId=Jt(o._dragStarted.bind(o,n,e)),P(document,"selectstart",o),Vt=!0,window.getSelection().removeAllRanges(),Pt&&E(document.body,"user-select","none")},_onDragOver:function(e){var n=this.el,o=e.target,i,a,l,c=this.options,h=c.group,u=_.active,p=Dt===h,f=c.sort,b=Q||u,w,g=this,S=!1;if(ge)return;function s(M,W){nt(M,g,ht({evt:e,isOwner:p,axis:w?"vertical":"horizontal",revert:l,dragRect:i,targetRect:a,canSort:f,fromSortable:b,target:o,completed:V,onMove:function(Z,U){return Gt(z,n,m,i,Z,X(Z),e,U)},changed:L},W))}function d(){s("dragOverAnimationCapture"),g.captureAnimationState(),g!==b&&b.captureAnimationState()}function V(M){return s("dragOverCompleted",{insertion:M}),M&&(p?u._hideClone():u._showClone(g),g!==b&&(it(m,Q?Q.options.ghostClass:u.options.ghostClass,!1),it(m,c.ghostClass,!0)),Q!==g&&g!==_.active?Q=g:g===_.active&&Q&&(Q=null),b===g&&(g._ignoreWhileAnimating=o),g.animateAll(function(){s("dragOverAnimationComplete"),g._ignoreWhileAnimating=null}),g!==b&&(b.animateAll(),b._ignoreWhileAnimating=null)),(o===m&&!m.animated||o===n&&!o.animated)&&(kt=null),!c.dragoverBubble&&!e.rootEl&&o!==document&&(m.parentNode[ot]._isOutsideThisEl(e.target),!M&&xt(e)),!c.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),S=!0}function L(){rt=st(m),vt=st(m,c.draggable),tt({sortable:g,name:"change",toEl:n,newIndex:rt,newDraggableIndex:vt,originalEvent:e})}if(e.preventDefault!==void 0&&e.cancelable&&e.preventDefault(),o=ct(o,c.draggable,n,!0),s("dragOver"),_.eventCanceled)return S;if(m.contains(e.target)||o.animated&&o.animatingX&&o.animatingY||g._ignoreWhileAnimating===o)return V(!1);if(te=!1,u&&!c.disabled&&(p?f||(l=q!==z):Q===this||(this.lastPutMode=Dt.checkPull(this,u,m,e))&&h.checkPut(this,u,m,e))){if(w=this._getDirection(e,o)==="vertical",i=X(m),s("dragOverValid"),_.eventCanceled)return S;if(l)return q=z,d(),this._hideClone(),s("revert"),_.eventCanceled||(Ct?z.insertBefore(m,Ct):z.appendChild(m)),V(!0);var k=ye(n,c.draggable);if(!k||Cn(e,w,this)&&!k.animated){if(k===m)return V(!1);if(k&&n===e.target&&(o=k),o&&(a=X(o)),Gt(z,n,m,i,o,a,e,!!o)!==!1)return d(),k&&k.nextSibling?n.insertBefore(m,k.nextSibling):n.appendChild(m),q=n,L(),V(!0)}else if(k&&xn(e,w,this)){var B=Mt(n,0,c,!0);if(B===m)return V(!1);if(o=B,a=X(o),Gt(z,n,m,i,o,a,e,!1)!==!1)return d(),n.insertBefore(m,B),q=n,L(),V(!0)}else if(o.parentNode===n){a=X(o);var j=0,r,F=m.parentNode!==n,T=!mn(m.animated&&m.toRect||i,o.animated&&o.toRect||a,w),K=w?"top":"left",J=He(o,"top","top")||He(m,"top","top"),C=J?J.scrollTop:void 0;kt!==o&&(r=a[K],Wt=!1,qt=!T&&c.invertSwap||F),j=wn(e,o,a,w,T?1:c.swapThreshold,c.invertedSwapThreshold==null?c.swapThreshold:c.invertedSwapThreshold,qt,kt===o);var y;if(j!==0){var v=st(m);do v-=j,y=q.children[v];while(y&&(E(y,"display")==="none"||y===H))}if(j===0||y===o)return V(!1);kt=o,jt=j;var A=o.nextElementSibling,x=!1;x=j===1;var O=Gt(z,n,m,i,o,a,e,x);if(O!==!1)return(O===1||O===-1)&&(x=O===1),ge=!0,setTimeout(Sn,30),d(),x&&!A?n.appendChild(m):o.parentNode.insertBefore(m,x?A:o),J&&Ye(J,0,C-J.scrollTop),q=m.parentNode,r!==void 0&&!qt&&(Ut=Math.abs(r-X(o)[K])),L(),V(!0)}if(n.contains(m))return V(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){N(document,"mousemove",this._onTouchMove),N(document,"touchmove",this._onTouchMove),N(document,"pointermove",this._onTouchMove),N(document,"dragover",xt),N(document,"mousemove",xt),N(document,"touchmove",xt)},_offUpEvents:function(){var e=this.el.ownerDocument;N(e,"mouseup",this._onDrop),N(e,"touchend",this._onDrop),N(e,"pointerup",this._onDrop),N(e,"pointercancel",this._onDrop),N(e,"touchcancel",this._onDrop),N(document,"selectstart",this)},_onDrop:function(e){var n=this.el,o=this.options;if(rt=st(m),vt=st(m,o.draggable),nt("drop",this,{evt:e}),q=m&&m.parentNode,rt=st(m),vt=st(m,o.draggable),_.eventCanceled){this._nulling();return}At=!1,qt=!1,Wt=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),ve(this.cloneId),ve(this._dragStartId),this.nativeDraggable&&(N(document,"drop",this),N(n,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),Pt&&E(document.body,"user-select",""),E(m,"transform",""),e&&(Vt&&(e.cancelable&&e.preventDefault(),!o.dropBubble&&e.stopPropagation()),H&&H.parentNode&&H.parentNode.removeChild(H),(z===q||Q&&Q.lastPutMode!=="clone")&&Y&&Y.parentNode&&Y.parentNode.removeChild(Y),m&&(this.nativeDraggable&&N(m,"dragend",this),he(m),m.style["will-change"]="",Vt&&!At&&it(m,Q?Q.options.ghostClass:this.options.ghostClass,!1),it(m,this.options.chosenClass,!1),tt({sortable:this,name:"unchoose",toEl:q,newIndex:null,newDraggableIndex:null,originalEvent:e}),z!==q?(rt>=0&&(tt({rootEl:q,name:"add",toEl:q,fromEl:z,originalEvent:e}),tt({sortable:this,name:"remove",toEl:q,originalEvent:e}),tt({rootEl:q,name:"sort",toEl:q,fromEl:z,originalEvent:e}),tt({sortable:this,name:"sort",toEl:q,originalEvent:e})),Q&&Q.save()):rt!==Et&&rt>=0&&(tt({sortable:this,name:"update",toEl:q,originalEvent:e}),tt({sortable:this,name:"sort",toEl:q,originalEvent:e})),_.active&&((rt==null||rt===-1)&&(rt=Et,vt=Ft),tt({sortable:this,name:"end",toEl:q,originalEvent:e}),this.save()))),this._nulling()},_nulling:function(){nt("nulling",this),z=m=q=H=Ct=Y=Kt=mt=St=lt=Vt=rt=vt=Et=Ft=kt=jt=Q=Dt=_.dragged=_.ghost=_.clone=_.active=null,ne.forEach(function(e){e.checked=!0}),ne.length=le=ce=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":m&&(this._onDragOver(e),yn(e));break;case"selectstart":e.preventDefault();break}},toArray:function(){for(var e=[],n,o=this.el.children,i=0,a=o.length,l=this.options;i<a;i++)n=o[i],ct(n,l.draggable,this.el,!1)&&e.push(n.getAttribute(l.dataIdAttr)||kn(n));return e},sort:function(e,n){var o={},i=this.el;this.toArray().forEach(function(a,l){var c=i.children[l];ct(c,this.options.draggable,i,!1)&&(o[a]=c)},this),n&&this.captureAnimationState(),e.forEach(function(a){o[a]&&(i.removeChild(o[a]),i.appendChild(o[a]))}),n&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,n){return ct(e,n||this.options.draggable,this.el,!1)},option:function(e,n){var o=this.options;if(n===void 0)return o[e];var i=zt.modifyOption(this,e,n);typeof i!="undefined"?o[e]=i:o[e]=n,e==="group"&&Xe(o)},destroy:function(){nt("destroy",this);var e=this.el;e[ot]=null,N(e,"mousedown",this._onTapStart),N(e,"touchstart",this._onTapStart),N(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(N(e,"dragover",this),N(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(n){n.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),ee.splice(ee.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!mt){if(nt("hideClone",this),_.eventCanceled)return;E(Y,"display","none"),this.options.removeCloneOnHide&&Y.parentNode&&Y.parentNode.removeChild(Y),mt=!0}},_showClone:function(e){if(e.lastPutMode!=="clone"){this._hideClone();return}if(mt){if(nt("showClone",this),_.eventCanceled)return;m.parentNode==z&&!this.options.group.revertClone?z.insertBefore(Y,m):Ct?z.insertBefore(Y,Ct):z.appendChild(Y),this.options.group.revertClone&&this.animate(m,Y),E(Y,"display",""),mt=!1}}};ie&&P(document,"touchmove",function(t){(_.active||At)&&t.cancelable&&t.preventDefault()});_.utils={on:P,off:N,css:E,find:Re,is:function(e,n){return!!ct(e,n,e,!1)},extend:cn,throttle:ze,closest:ct,toggleClass:it,clone:De,index:st,nextTick:Jt,cancelNextTick:ve,detectDirection:Ge,getChild:Mt,expando:ot};_.get=function(t){return t[ot]};_.mount=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];e[0].constructor===Array&&(e=e[0]),e.forEach(function(o){if(!o.prototype||!o.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(o));o.utils&&(_.utils=ht(ht({},_.utils),o.utils)),zt.mount(o)})};_.create=function(t,e){return new _(t,e)};_.version=sn;G=[],be=!1;pe=ze(function(t,e,n,o){if(e.scroll){var i=(t.touches?t.touches[0]:t).clientX,a=(t.touches?t.touches[0]:t).clientY,l=e.scrollSensitivity,c=e.scrollSpeed,h=dt(),u=!1,p;me!==n&&(me=n,Qt(),Lt=e.scroll,p=e.scrollFn,Lt===!0&&(Lt=bt(n,!0)));var f=0,b=Lt;do{var w=b,g=X(w),S=g.top,s=g.bottom,d=g.left,V=g.right,L=g.width,k=g.height,B=void 0,j=void 0,r=w.scrollWidth,F=w.scrollHeight,T=E(w),K=w.scrollLeft,J=w.scrollTop;w===h?(B=L<r&&(T.overflowX==="auto"||T.overflowX==="scroll"||T.overflowX==="visible"),j=k<F&&(T.overflowY==="auto"||T.overflowY==="scroll"||T.overflowY==="visible")):(B=L<r&&(T.overflowX==="auto"||T.overflowX==="scroll"),j=k<F&&(T.overflowY==="auto"||T.overflowY==="scroll"));var C=B&&(Math.abs(V-i)<=l&&K+L<r)-(Math.abs(d-i)<=l&&!!K),y=j&&(Math.abs(s-a)<=l&&J+k<F)-(Math.abs(S-a)<=l&&!!J);if(!G[f])for(var v=0;v<=f;v++)G[v]||(G[v]={});(G[f].vx!=C||G[f].vy!=y||G[f].el!==w)&&(G[f].el=w,G[f].vx=C,G[f].vy=y,clearInterval(G[f].pid),(C!=0||y!=0)&&(u=!0,G[f].pid=setInterval(function(){o&&this.layer===0&&_.active._onTouchMove(oe);var A=G[this.layer].vy?G[this.layer].vy*c:0,x=G[this.layer].vx?G[this.layer].vx*c:0;typeof p=="function"&&p.call(_.dragged.parentNode[ot],x,A,t,oe,G[this.layer].el)!=="continue"||Ye(G[this.layer].el,x,A)}.bind({layer:f}),24))),f++}while(e.bubbleScroll&&b!==h&&(b=bt(b,!1)));be=u}},30),Je=function(e){var n=e.originalEvent,o=e.putSortable,i=e.dragEl,a=e.activeSortable,l=e.dispatchSortableEvent,c=e.hideGhostForTarget,h=e.unhideGhostForTarget;if(n){var u=o||a;c();var p=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:n,f=document.elementFromPoint(p.clientX,p.clientY);h(),u&&!u.el.contains(f)&&(l("spill"),this.onSpill({dragEl:i,putSortable:o}))}};Se.prototype={startIndex:null,dragStart:function(e){var n=e.oldDraggableIndex;this.startIndex=n},onSpill:function(e){var n=e.dragEl,o=e.putSortable;this.sortable.captureAnimationState(),o&&o.captureAnimationState();var i=Mt(this.sortable.el,this.startIndex,this.options);i?this.sortable.el.insertBefore(n,i):this.sortable.el.appendChild(n),this.sortable.animateAll(),o&&o.animateAll()},drop:Je};ft(Se,{pluginName:"revertOnSpill"});xe.prototype={onSpill:function(e){var n=e.dragEl,o=e.putSortable,i=o||this.sortable;i.captureAnimationState(),n.parentNode&&n.parentNode.removeChild(n),i.animateAll()},drop:Je};ft(xe,{pluginName:"removeOnSpill"});_.mount(new En);_.mount(xe,Se);Qe=_});var tn=ke((Ce,we)=>{(function(t,e){typeof Ce=="object"&&typeof we!="undefined"?we.exports=e():typeof define=="function"&&define.amd?define(e):(t=typeof globalThis!="undefined"?globalThis:t||self).dayjs=e()})(Ce,function(){"use strict";var t=1e3,e=6e4,n=36e5,o="millisecond",i="second",a="minute",l="hour",c="day",h="week",u="month",p="quarter",f="year",b="date",w="Invalid Date",g=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,S=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,s={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(C){var y=["th","st","nd","rd"],v=C%100;return"["+C+(y[(v-20)%10]||y[v]||y[0])+"]"}},d=function(C,y,v){var A=String(C);return!A||A.length>=y?C:""+Array(y+1-A.length).join(v)+C},V={s:d,z:function(C){var y=-C.utcOffset(),v=Math.abs(y),A=Math.floor(v/60),x=v%60;return(y<=0?"+":"-")+d(A,2,"0")+":"+d(x,2,"0")},m:function C(y,v){if(y.date()<v.date())return-C(v,y);var A=12*(v.year()-y.year())+(v.month()-y.month()),x=y.clone().add(A,u),O=v-x<0,M=y.clone().add(A+(O?-1:1),u);return+(-(A+(v-x)/(O?x-M:M-x))||0)},a:function(C){return C<0?Math.ceil(C)||0:Math.floor(C)},p:function(C){return{M:u,y:f,w:h,d:c,D:b,h:l,m:a,s:i,ms:o,Q:p}[C]||String(C||"").toLowerCase().replace(/s$/,"")},u:function(C){return C===void 0}},L="en",k={};k[L]=s;var B="$isDayjsObject",j=function(C){return C instanceof K||!(!C||!C[B])},r=function C(y,v,A){var x;if(!y)return L;if(typeof y=="string"){var O=y.toLowerCase();k[O]&&(x=O),v&&(k[O]=v,x=O);var M=y.split("-");if(!x&&M.length>1)return C(M[0])}else{var W=y.name;k[W]=y,x=W}return!A&&x&&(L=x),x||!A&&L},F=function(C,y){if(j(C))return C.clone();var v=typeof y=="object"?y:{};return v.date=C,v.args=arguments,new K(v)},T=V;T.l=r,T.i=j,T.w=function(C,y){return F(C,{locale:y.$L,utc:y.$u,x:y.$x,$offset:y.$offset})};var K=function(){function C(v){this.$L=r(v.locale,null,!0),this.parse(v),this.$x=this.$x||v.x||{},this[B]=!0}var y=C.prototype;return y.parse=function(v){this.$d=function(A){var x=A.date,O=A.utc;if(x===null)return new Date(NaN);if(T.u(x))return new Date;if(x instanceof Date)return new Date(x);if(typeof x=="string"&&!/Z$/i.test(x)){var M=x.match(g);if(M){var W=M[2]-1||0,D=(M[7]||"0").substring(0,3);return O?new Date(Date.UTC(M[1],W,M[3]||1,M[4]||0,M[5]||0,M[6]||0,D)):new Date(M[1],W,M[3]||1,M[4]||0,M[5]||0,M[6]||0,D)}}return new Date(x)}(v),this.init()},y.init=function(){var v=this.$d;this.$y=v.getFullYear(),this.$M=v.getMonth(),this.$D=v.getDate(),this.$W=v.getDay(),this.$H=v.getHours(),this.$m=v.getMinutes(),this.$s=v.getSeconds(),this.$ms=v.getMilliseconds()},y.$utils=function(){return T},y.isValid=function(){return this.$d.toString()!==w},y.isSame=function(v,A){var x=F(v);return this.startOf(A)<=x&&x<=this.endOf(A)},y.isAfter=function(v,A){return F(v)<this.startOf(A)},y.isBefore=function(v,A){return this.endOf(A)<F(v)},y.$g=function(v,A,x){return T.u(v)?this[A]:this.set(x,v)},y.unix=function(){return Math.floor(this.valueOf()/1e3)},y.valueOf=function(){return this.$d.getTime()},y.startOf=function(v,A){var x=this,O=!!T.u(A)||A,M=T.p(v),W=function(yt,et){var gt=T.w(x.$u?Date.UTC(x.$y,et,yt):new Date(x.$y,et,yt),x);return O?gt:gt.endOf(c)},D=function(yt,et){return T.w(x.toDate()[yt].apply(x.toDate("s"),(O?[0,0,0,0]:[23,59,59,999]).slice(et)),x)},Z=this.$W,U=this.$M,at=this.$D,wt="set"+(this.$u?"UTC":"");switch(M){case f:return O?W(1,0):W(31,11);case u:return O?W(1,U):W(0,U+1);case h:var $t=this.$locale().weekStart||0,Ot=(Z<$t?Z+7:Z)-$t;return W(O?at-Ot:at+(6-Ot),U);case c:case b:return D(wt+"Hours",0);case l:return D(wt+"Minutes",1);case a:return D(wt+"Seconds",2);case i:return D(wt+"Milliseconds",3);default:return this.clone()}},y.endOf=function(v){return this.startOf(v,!1)},y.$set=function(v,A){var x,O=T.p(v),M="set"+(this.$u?"UTC":""),W=(x={},x[c]=M+"Date",x[b]=M+"Date",x[u]=M+"Month",x[f]=M+"FullYear",x[l]=M+"Hours",x[a]=M+"Minutes",x[i]=M+"Seconds",x[o]=M+"Milliseconds",x)[O],D=O===c?this.$D+(A-this.$W):A;if(O===u||O===f){var Z=this.clone().set(b,1);Z.$d[W](D),Z.init(),this.$d=Z.set(b,Math.min(this.$D,Z.daysInMonth())).$d}else W&&this.$d[W](D);return this.init(),this},y.set=function(v,A){return this.clone().$set(v,A)},y.get=function(v){return this[T.p(v)]()},y.add=function(v,A){var x,O=this;v=Number(v);var M=T.p(A),W=function(U){var at=F(O);return T.w(at.date(at.date()+Math.round(U*v)),O)};if(M===u)return this.set(u,this.$M+v);if(M===f)return this.set(f,this.$y+v);if(M===c)return W(1);if(M===h)return W(7);var D=(x={},x[a]=e,x[l]=n,x[i]=t,x)[M]||1,Z=this.$d.getTime()+v*D;return T.w(Z,this)},y.subtract=function(v,A){return this.add(-1*v,A)},y.format=function(v){var A=this,x=this.$locale();if(!this.isValid())return x.invalidDate||w;var O=v||"YYYY-MM-DDTHH:mm:ssZ",M=T.z(this),W=this.$H,D=this.$m,Z=this.$M,U=x.weekdays,at=x.months,wt=x.meridiem,$t=function(et,gt,Ht,Yt){return et&&(et[gt]||et(A,O))||Ht[gt].slice(0,Yt)},Ot=function(et){return T.s(W%12||12,et,"0")},yt=wt||function(et,gt,Ht){var Yt=et<12?"AM":"PM";return Ht?Yt.toLowerCase():Yt};return O.replace(S,function(et,gt){return gt||function(Ht){switch(Ht){case"YY":return String(A.$y).slice(-2);case"YYYY":return T.s(A.$y,4,"0");case"M":return Z+1;case"MM":return T.s(Z+1,2,"0");case"MMM":return $t(x.monthsShort,Z,at,3);case"MMMM":return $t(at,Z);case"D":return A.$D;case"DD":return T.s(A.$D,2,"0");case"d":return String(A.$W);case"dd":return $t(x.weekdaysMin,A.$W,U,2);case"ddd":return $t(x.weekdaysShort,A.$W,U,3);case"dddd":return U[A.$W];case"H":return String(W);case"HH":return T.s(W,2,"0");case"h":return Ot(1);case"hh":return Ot(2);case"a":return yt(W,D,!0);case"A":return yt(W,D,!1);case"m":return String(D);case"mm":return T.s(D,2,"0");case"s":return String(A.$s);case"ss":return T.s(A.$s,2,"0");case"SSS":return T.s(A.$ms,3,"0");case"Z":return M}return null}(et)||M.replace(":","")})},y.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},y.diff=function(v,A,x){var O,M=this,W=T.p(A),D=F(v),Z=(D.utcOffset()-this.utcOffset())*e,U=this-D,at=function(){return T.m(M,D)};switch(W){case f:O=at()/12;break;case u:O=at();break;case p:O=at()/3;break;case h:O=(U-Z)/6048e5;break;case c:O=(U-Z)/864e5;break;case l:O=U/n;break;case a:O=U/e;break;case i:O=U/t;break;default:O=U}return x?O:T.a(O)},y.daysInMonth=function(){return this.endOf(u).$D},y.$locale=function(){return k[this.$L]},y.locale=function(v,A){if(!v)return this.$L;var x=this.clone(),O=r(v,A,!0);return O&&(x.$L=O),x},y.clone=function(){return T.w(this.$d,this)},y.toDate=function(){return new Date(this.valueOf())},y.toJSON=function(){return this.isValid()?this.toISOString():null},y.toISOString=function(){return this.$d.toISOString()},y.toString=function(){return this.$d.toUTCString()},C}(),J=K.prototype;return F.prototype=J,[["$ms",o],["$s",i],["$m",a],["$H",l],["$W",c],["$M",u],["$y",f],["$D",b]].forEach(function(C){J[C[1]]=function(y){return this.$g(y,C[0],C[1])}}),F.extend=function(C,y){return C.$i||(C(y,K,F),C.$i=!0),F},F.locale=r,F.isDayjs=j,F.unix=function(C){return F(1e3*C)},F.en=k[L],F.Ls=k,F.p={},F})});var _n=ke(en=>{Ae();Ie();var re=tn();fetch("widgets/tvprogram/i18n/translations.json").then(t=>R(en,null,function*(){let e=yield t.json();$.extend(!0,systemDictionary,e)}));$.extend(!0,systemDictionary,{});vis.binds.tvprogram={version:Ee,showVersion:function(){vis.binds.tvprogram.version&&(console.log(`Version tvprogram: ${vis.binds.tvprogram.version}`),vis.binds.tvprogram.version=null)},pending:{},categories:null,channels:null,genres:null,tvprogram:[],infos:null,requests:[],search:{visTvprogram:null,bound:{},searchdata:[],searchresult:[],createWidget:function(t,e,n,o){return R(this,null,function*(){let i=$(`#${t}`);if(!i.length)return setTimeout(function(){vis.binds.tvprogram.search.createWidget(t,e,n,o)},100);if(console.log("createWidget start"),this.visTvprogram=vis.binds.tvprogram,!n.tvprogram_oid||n.tvprogram_oid=="")return;let[a,l]=this.visTvprogram.getInstanceInfo(n.tvprogram_oid);if(!l&&!a)return;let c=this.visTvprogram.realBackgroundColor($(`#${t}`)[0]);this.visTvprogram.checkStyle("background-color",$(`#${t}`)[0].style.cssText)==""&&$(`#${t}`).css("background-color",c);let h=parseInt(n.tvprogram_maxresults)||10,u=parseInt(n.tvprogram_heightRow)||35,p=parseInt(n.tvprogram_broadcastfontpercent)||75,f=n.tvprogram_highlightcolor||"yellow",b=n.tvprogram_showpictures||!1,w=n.tvprogram_dialogwidthpercent/100||.9,g=n.tvprogram_dialogheightpercent/100||.9;if(this.searchresult[l]||(this.searchresult[l]={}),this.searchresult[l][t]||(this.searchresult[l][t]=[]),this.searchdata[l]||(this.searchdata[l]={}),this.searchdata[l][t]||(this.searchdata[l][t]={datefrom:new Date().toISOString().split("T")[0],categoryfilter:"",textfilter:"",maxresults:h||10}),this.bound[l]||(this.bound[l]={}),this.bound[l][t]||(this.bound[l][t]=!1),l&&!this.bound[l][t]&&(vis.editMode||(this.bound[l][t]=!0,vis.binds.tvprogram.bindStates(i,[`${l}.config`,`${l}.favorites`,`${l}.channelfilter`],this.onChange.bind(this,t,e,n,o,l)))),this.visTvprogram.infos||(this.visTvprogram.infos=yield this.visTvprogram.loadServerInfosAsync(a)),this.visTvprogram.categories||(this.visTvprogram.categories=yield this.visTvprogram.loadCategories(a,t)),this.visTvprogram.channels||(this.visTvprogram.channels=yield this.visTvprogram.loadChannels(a,t)),this.visTvprogram.infos==null||!Object.prototype.hasOwnProperty.call(this.visTvprogram.infos,"tvprogram")||this.visTvprogram.categories.length==0||this.visTvprogram.channels.length==0)return;let S=this.visTvprogram.categories.map(k=>`<option value="${k.id}" ${this.searchdata[l][t].categoryfilter==k.id?" selected":""}>${k.title}</option>`);S=`<option value="" ${this.searchdata[l][t].categoryfilter==""?" selected":""}></option>${S}`,$(`#${t}broadcastdlg`).data({dialogwidthpercent:w,dialogheightpercent:g});let s="";s+=`<style> 
`,s+=`#${t} * {
`,s+=`   box-sizing: border-box; 
`,s+=`} 
`,s+=`#${t} .tv-search {
`,s+=`   width: 100%; 
`,s+=`   height: 100%; 
`,s+=`   white-space:nowrap; 
`,s+=`   display:flex; 
`,s+=`   flex-direction: column; 
`,s+=`} 
`,s+=`#${t} .tv-form {
`,s+=`   padding: 5px 0px; 
`,s+=`} 
`,s+=`#${t} .tv-result {
`,s+=`   overflow: hidden; 
`,s+=`   overflow-y: auto; 
`,s+=`} 
`,s+=`#${t} .tv-row {
`,s+=`   margin: 0px; 
`,s+=`   padding: 0px; 
`,s+=`   width: 100%; 
`,s+=`} 
`,s+=`#${t} .tv-search .tv-row:nth-child(odd) {
`,s+=`   background-color: rgba(128,127,127,.65); 
`,s+=`   padding: 0px; 
`,s+=`} 
`,s+=`#${t} .tv-search .tv-row:nth-child(even) {
`,s+=`   background-color: rgba(128,127,127,.55); 
`,s+=`   padding: 0px; 
`,s+=`} 
`,s+=`#${t} .tv-item {
`,s+=`   display: inline-block; 
`,s+=`   vertical-align: middle; 
`,s+=`   border: solid #80808033; 
`,s+=`   border-width:1px 0px 0px 1px; 
`,s+=`} 
`,s+=`#${t} .channel {
`,s+=`   width: ${u}px; 
`,s+=`   height: ${u}px; 
`,s+=`   padding: 1px; 
`,s+=`   background-color: ${c}; 
`,s+=`} 
`,s+=`#${t} .broadcast {
`,s+=`   height: ${u}px; 
`,s+=`   padding: 3px; 
`,s+=`   font-size: ${p}%; 
`,s+=`   overflow: hidden; 
`,s+=`   width: 100%; 
`,s+=`} 
`,s+=`#${t} .broadcastelement {
`,s+=`   width: 100%; 
`,s+=`   height: 100%; 
`,s+=`   display: table-cell; 
`,s+=`} 
`,s+=`#${t} .broadcastelement .star  {
`,s+=`   display: inline-block; 
`,s+=`   margin: 0px 2px; 
`,s+=`} 
`,s+=`#${t} .broadcastelement .star svg {
`,s+=`   height: 1em; 
`,s+=`   width: 1em; 
`,s+=`   position: relative; 
`,s+=`   top: .125em; 
`,s+=`} 
`,s+=`#${t} .broadcastelement.selected .star svg path {
`,s+=`   color: ${f}; 
`,s+=`} 
`,s+=`#${t} .broadcastelement.selected {
`,s+=`   color: ${f}; 
`,s+=`} 
`,s+=`#${t} .broadcastimage {
`,s+=`   height: ${u-7}px; 
`,s+=`   padding-right: 3px; 
`,s+=`   float: left; 
`,s+=`} 
`,s+=`.${t}.no-titlebar .ui-dialog-titlebar {
`,s+=`   display:none; 
`,s+=`} 
`,s+=`#${t}broadcastdlg  {
`,s+=`   z-index:12; 
`,s+=`} 
`,s+=`#${t}broadcastdlg .event-container.tv-dlg-row {
`,s+=`   height:100%; 
`,s+=`   display:flex; 
`,s+=`   flex-direction:row; 
`,s+=`   overflow:hidden; 
`,s+=`} 
`,s+=`#${t}broadcastdlg .event-container.tv-dlg-col {
`,s+=`   height:100%; 
`,s+=`   display:flex; 
`,s+=`   flex-direction:column; 
`,s+=`   overflow:hidden; 
`,s+=`   font-size:75%; 
`,s+=`} 
`,s+=`#${t}broadcastdlg .event-picture.tv-dlg-row {
`,s+=`   width:50%; 
`,s+=`} 
`,s+=`#${t}broadcastdlg .event-picture.tv-dlg-col {
`,s+=`   height:30%; 
`,s+=`} 
`,s+=`#${t}broadcastdlg .event-data {
`,s+=`   overflow-y:auto; 
`,s+=`} 
`,s+=`#${t}broadcastdlg .event-picture img {
`,s+=`   width:auto; 
`,s+=`   height:auto; 
`,s+=`   max-width:100%; 
`,s+=`   max-height:100%; 
`,s+=`   display:block; 
`,s+=`   margin:auto; 
`,s+=`} 
`,s+=`#${t}broadcastdlg .event-picture img {
`,s+=`   width:auto; 
`,s+=`   height:auto; 
`,s+=`   max-width:100%; 
`,s+=`   max-height:100%; 
`,s+=`   display:block; 
`,s+=`   margin:auto; 
`,s+=`} 
`,s+=`#${t}broadcastdlg .dialogcolumn.tv-dlg-row {
`,s+=`   flex:1; 
`,s+=`   padding:5px; 
`,s+=`} 
`,s+=`#${t}broadcastdlg .dialogcolumn.tv-dlg-col {
`,s+=`   padding:5px; 
`,s+=`} 
`,s+=`#${t}broadcastdlg .button {
`,s+=`   display:inline-block; 
`,s+=`   width: 35px; 
`,s+=`   height: 35px; 
`,s+=`   vertical-align: middle; 
`,s+=`   position: relative; 
`,s+=`   float: right; 
`,s+=`} 
`,s+=`#${t}broadcastdlg .star.selected svg  {
`,s+=`   filter: drop-shadow( 2px 2px 2px rgba(0, 0, 0, .7))
`,s+=`} 
`,s+=`#${t} .broadcastelement.selected .star svg path, #${t}broadcastdlg .star.selected {
`,s+=`   color: ${f}; 
`,s+=`} 
`,s+=`</style> 
`,s+='  <div class="svgcontainer">',s+='<svg style="display:none;"><symbol id="star-icon" viewBox="0 0 24 24"><path fill="currentColor" d="M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z" /></symbol></svg>',s+='<svg style="display:none;"><symbol id="copy-icon" viewBox="0 0 24 24"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" /></symbol></svg>',s+='<svg style="display:none;"><symbol id="switch-icon" viewBox="0 0 24 24"><path fill="currentColor" d="M21,3H3C1.89,3 1,3.89 1,5V17A2,2 0 0,0 3,19H8V21H16V19H21A2,2 0 0,0 23,17V5C23,3.89 22.1,3 21,3M21,17H3V5H21M16,11L9,15V7" /></symbol></svg>',s+='<svg style="display:none;"><symbol id="record-icon" viewBox="0 0 24 24"><path fill="currentColor" d="M12.5,5A7.5,7.5 0 0,0 5,12.5A7.5,7.5 0 0,0 12.5,20A7.5,7.5 0 0,0 20,12.5A7.5,7.5 0 0,0 12.5,5M7,10H9A1,1 0 0,1 10,11V12C10,12.5 9.62,12.9 9.14,12.97L10.31,15H9.15L8,13V15H7M12,10H14V11H12V12H14V13H12V14H14V15H12A1,1 0 0,1 11,14V11A1,1 0 0,1 12,10M16,10H18V11H16V14H18V15H16A1,1 0 0,1 15,14V11A1,1 0 0,1 16,10M8,11V12H9V11" /></symbol></svg>',s+="  </div>",s+=`  <form data-instance="${a}" data-dp="${l}" data-widgetid="${t}" data-maxresults="${h}" >`,s+='    <label for="tvsearch">Search:',s+=`      <input name="tvsearch" type="text" id="tvsearch" value="${this.searchdata[l][t].textfilter}" placeholder="Search">`,s+="    </label>",s+='    <label for="tvfrom">From:',s+=`      <input name="tvfrom" autocomplete="off"  type="date" id="tvfrom" min="${this.visTvprogram.infos.tvprogram[0]}" max="${this.visTvprogram.infos.tvprogram[this.visTvprogram.infos.tvprogram.length-1]}" value="${this.searchdata[l][t].datefrom}">`,s+="    </label>",s+='    <label for="tvcategory">Category:',s+='      <select name="tvcategory" id="tvcategory" >',s+=S,s+="      </select>",s+="    </label>",s+="  <button>Search</Search>",s+="  </form>",$(`#${t} .tv-form`).html(s),$(`#${t} .tv-form form`).submit(this.onSubmitSearch.bind(this,t,e,n,o));let d,V;s="";let L=this.visTvprogram.getConfigFavorites(l);this.searchresult[l][t].map((k,B)=>{if(B+1>h)return;let j=this.visTvprogram.channels.find(T=>T.id==k.channel);d=L.indexOf(k.title)>-1,V=k.airDate,s+='    <ul class="tv-row">',s+='       <li class="tv-item channel">',s+=`          <img width="100%" height="100%" data-channelid="${j.channelId}" data-dp="${l}" data-instance="${a}" src="https://tvfueralle.de/channel-logos/${j.channelId}.png" alt="" class="channel-logo"  onclick="vis.binds.tvprogram.onclickChannelSwitch(this,event)">`,s+="       </li>",s+='       <li class="tv-item broadcast">',s+=`             <div class="broadcastelement ${d?"selected":""}" data-widgetid="${t}" data-eventid="${k.id}" data-viewdate="${V}" data-instance="${a}" data-dp="${l}" data-view="" >`,k.photo.url&&b&&(s+=`<div><img class="broadcastimage" src="https://tvfueralle.de${k.photo.url}"></div>`),s+='                 <div class="broadcasttitle">',s+=`                     ${k.title}`,s+=`                     <div class="star" data-viewdate="${V}" data-eventid="${k.id}" data-instance="${a}" data-dp="${l}" onclick="return vis.binds.tvprogram.onclickFavorite(this,event)"><svg width="100%" height="100%" ><use xlink:href="#star-icon"></use></svg></div>`,s+="                 </div>";let r=new Date(k.startTime),F=new Date(k.endTime);s+='                 <div class="broadcasttime">',s+=`${`0${r.getDate()}`.slice(-2)}.${`0${parseInt(r.getMonth()+1)}`.slice(-2)}.${`0${r.getFullYear()}`.slice(-4)} `,s+=`${`0${r.getHours()}`.slice(-2)}:${`0${r.getMinutes()}`.slice(-2)}`,s+=" - ",s+=`${`0${F.getHours()}`.slice(-2)}:${`0${F.getMinutes()}`.slice(-2)}`,s+="                 </div>",s+="             </div>",s+="       </li>",s+="    </ul>"}),$(`#${t} .tv-result`).html(s),$(`#${t} .tv-result .broadcastelement`).click(vis.binds.tvprogram.onclickBroadcast.bind(this.visTvprogram))})},onSubmitSearch:function(t,e,n,o,i){return R(this,null,function*(){let a=i.target,l=a.dataset.instance||"",c=a.dataset.dp||"";i.preventDefault();let h=$(a).find('[name="tvsearch"]').val(),u=$(a).find('[name="tvcategory"]').val(),p=$(a).find('[name="tvfrom"]').val();if(!this.parseDatestring(p))return!1;let f=this.visTvprogram.getConfigChannelfilter(c);f.length==0&&(f=this.visTvprogram.channels.reduce((s,d,V)=>(V<4&&s.push(d.id),s),[])),this.searchdata[c]||(this.searchdata[c]={}),this.searchdata[c][t]=Object.assign(this.searchdata[c][t],{datefrom:p,categoryfilter:[u],textfilter:h});let b=new Date,w=this.parseDatestring(p);b.getDate()==w.getDate()&&b.getMonth()==w.getMonth()&&b.getFullYear()==w.getFullYear()?(w.setHours(b.getHours()),w.setMinutes(b.getMinutes()),w.setSeconds(b.getSeconds())):(w.setHours(0),w.setMinutes(0),w.setSeconds(0));let g=new Date(b);g.setDate(g.getDate()+10);let S={channelfilter:f,datefrom:w,datetill:g,categoryfilter:u==""?[]:[parseInt(u)],textfilter:h,maxresults:this.searchdata[c][t].maxresults};if(h==""&&u=="")return!1;this.searchresult[c][t]=yield this.visTvprogram.getServerBroadcastFindAsync(l,S),this.createWidget(t,e,n,o)})},parseDatestring:function(t){let e=t.split(/\D/),n=new Date(e[0],--e[1],e[2]);return n&&n.getMonth()==e[1]?n:!1},onChange:function(t,e,n,o,i,a,l){let c=a.type.split(".");(c[3]=="config"||c[3]=="favorites"||c[3]=="channelfilter"||c[3]=="show")&&c[4]=="val"&&(console.log(`changed ${t} type:${a.type} val:${l}`),this.createWidget(t,e,n,o))}},control:{visTvprogram:null,bound:{},programdata:{},favorites:void 0,timer:{},createWidget:function(t,e,n,o){return R(this,null,function*(){let i=$(`#${t}`);if(!i.length)return setTimeout(function(){vis.binds.tvprogram.control.createWidget(t,e,n,o)},100);if(console.log("createWidget control start"),this.visTvprogram=vis.binds.tvprogram,!n.tvprogram_oid||n.tvprogram_oid=="")return;let[a,l]=this.visTvprogram.getInstanceInfo(n.tvprogram_oid);if(!l&&!a||(this.visTvprogram.categories=yield this.visTvprogram.loadCategories(a,t),this.visTvprogram.channels=yield this.visTvprogram.loadChannels(a,t),this.visTvprogram.channels.length==0||this.visTvprogram.categories.length==0))return;let c=this.visTvprogram.realBackgroundColor($(`#${t}`)[0]);this.visTvprogram.checkStyle("background-color",$(`#${t}`)[0].style.cssText)==""&&$(`#${t}`).css("background-color",c);let h=this.visTvprogram.getConfigChannelfilter(l);h.length==0&&(h=this.visTvprogram.channels.reduce((k,B,j)=>(j<4&&k.push(B.id),k),[]));let u=n.tvprogram_time||"";this.programdata[l]||(this.programdata[l]={});let p=this.parseTime(u);this.programdata[l][t]=yield this.visTvprogram.getServerBroadcastRangeAsync(a,h,p,p),this.bound[l]||(this.bound[l]={}),this.bound[l][t]||(this.bound[l][t]=!1),l&&!this.bound[l][t]&&(vis.editMode||(this.bound[l][t]=!0,vis.binds.tvprogram.bindStates(i,[`${l}.config`,`${l}.favorites`,`${l}.channelfilter`],this.onChange.bind(this,t,e,n,o,l))));let f=parseInt(n.tvprogram_heightRow)||35,b=parseInt(n.tvprogram_broadcastfontpercent)||75,w=n.tvprogram_highlightcolor||"yellow",g=n.tvprogram_showpictures||!1,S=n.tvprogram_dialogwidthpercent/100||.9,s=n.tvprogram_dialogheightpercent/100||.9;$(`#${t}broadcastdlg`).data({dialogwidthpercent:S,dialogheightpercent:s});let d="";d+=`<style> 
`,d+=`#${t} * {
`,d+=`   box-sizing: border-box; 
`,d+=`} 
`,d+=`#${t} .tv-control {
`,d+=`   width: 100%; 
`,d+=`   height: 100%; 
`,d+=`   white-space:nowrap; 
`,d+=`   display:flex; 
`,d+=`   flex-direction: column; 
`,d+=`   overflow: hidden; 
`,d+=`   overflow-y: auto; 
`,d+=`} 
`,d+=`#${t} .tv-row {
`,d+=`   margin: 0px; 
`,d+=`   padding: 0px; 
`,d+=`   width: 100%; 
`,d+=`} 
`,d+=`#${t} .tv-control .tv-row:nth-child(odd) {
`,d+=`   background-color: rgba(128,127,127,.65); 
`,d+=`   padding: 0px; 
`,d+=`} 
`,d+=`#${t} .tv-control .tv-row:nth-child(even) {
`,d+=`   background-color: rgba(128,127,127,.55); 
`,d+=`   padding: 0px; 
`,d+=`} 
`,d+=`#${t} .tv-item {
`,d+=`   display: inline-block; 
`,d+=`   vertical-align: middle; 
`,d+=`   border: solid #80808033; 
`,d+=`   border-width:1px 0px 0px 1px; 
`,d+=`} 
`,d+=`#${t} .channel {
`,d+=`   width: ${f}px; 
`,d+=`   height: ${f}px; 
`,d+=`   padding: 1px; 
`,d+=`   background-color: ${c}; 
`,d+=`} 
`,d+=`#${t} .broadcast {
`,d+=`   height: ${f}px; 
`,d+=`   padding: 3px; 
`,d+=`   font-size: ${b}%; 
`,d+=`   overflow: hidden; 
`,d+=`   width: 100%; 
`,d+=`} 
`,d+=`#${t} .broadcastelement {
`,d+=`   width: 100%; 
`,d+=`   height: 100%; 
`,d+=`   display: table-cell; 
`,d+=`} 
`,d+=`#${t} .broadcastelement .star  {
`,d+=`   display: inline-block; 
`,d+=`   margin: 0px 2px; 
`,d+=`} 
`,d+=`#${t} .broadcastelement .star svg {
`,d+=`   height: 1em; 
`,d+=`   width: 1em; 
`,d+=`   position: relative; 
`,d+=`   top: .125em; 
`,d+=`} 
`,d+=`#${t} .broadcastelement.selected .star svg path {
`,d+=`   color: ${w}; 
`,d+=`} 
`,d+=`#${t} .broadcastelement.selected {
`,d+=`   color: ${w}; 
`,d+=`} 
`,d+=`#${t} .broadcastimage {
`,d+=`   height: ${f-7}px; 
`,d+=`   padding-right: 3px; 
`,d+=`   float: left; 
`,d+=`} 
`,d+=`.${t}.no-titlebar .ui-dialog-titlebar {
`,d+=`   display:none; 
`,d+=`} 
`,d+=`#${t}broadcastdlg  {
`,d+=`   z-index:12; 
`,d+=`} 
`,d+=`#${t}broadcastdlg .event-container.tv-dlg-row {
`,d+=`   height:100%; 
`,d+=`   display:flex; 
`,d+=`   flex-direction:row; 
`,d+=`   overflow:hidden; 
`,d+=`} 
`,d+=`#${t}broadcastdlg .event-container.tv-dlg-col {
`,d+=`   height:100%; 
`,d+=`   display:flex; 
`,d+=`   flex-direction:column; 
`,d+=`   overflow:hidden; 
`,d+=`   font-size:75%; 
`,d+=`} 
`,d+=`#${t}broadcastdlg .event-picture.tv-dlg-row {
`,d+=`   width:50%; 
`,d+=`} 
`,d+=`#${t}broadcastdlg .event-picture.tv-dlg-col {
`,d+=`   height:30%; 
`,d+=`} 
`,d+=`#${t}broadcastdlg .event-data {
`,d+=`   overflow-y:auto; 
`,d+=`} 
`,d+=`#${t}broadcastdlg .event-picture img {
`,d+=`   width:auto; 
`,d+=`   height:auto; 
`,d+=`   max-width:100%; 
`,d+=`   max-height:100%; 
`,d+=`   display:block; 
`,d+=`   margin:auto; 
`,d+=`} 
`,d+=`#${t}broadcastdlg .event-picture img {
`,d+=`   width:auto; 
`,d+=`   height:auto; 
`,d+=`   max-width:100%; 
`,d+=`   max-height:100%; 
`,d+=`   display:block; 
`,d+=`   margin:auto; 
`,d+=`} 
`,d+=`#${t}broadcastdlg .dialogcolumn.tv-dlg-row {
`,d+=`   flex:1; 
`,d+=`   padding:5px; 
`,d+=`} 
`,d+=`#${t}broadcastdlg .dialogcolumn.tv-dlg-col {
`,d+=`   padding:5px; 
`,d+=`} 
`,d+=`#${t}broadcastdlg .button {
`,d+=`   display:inline-block; 
`,d+=`   width: 35px; 
`,d+=`   height: 35px; 
`,d+=`   vertical-align: middle; 
`,d+=`   position: relative; 
`,d+=`   float: right; 
`,d+=`} 
`,d+=`#${t}broadcastdlg .star.selected svg  {
`,d+=`   filter: drop-shadow( 2px 2px 2px rgba(0, 0, 0, .7))
`,d+=`} 
`,d+=`#${t} .broadcastelement.selected .star svg path, #${t}broadcastdlg .star.selected {
`,d+=`   color: ${w}; 
`,d+=`} 
`,d+=`</style> 
`,d+='  <div class="svgcontainer">',d+='<svg style="display:none;"><symbol id="star-icon" viewBox="0 0 24 24"><path fill="currentColor" d="M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z" /></symbol></svg>',d+='<svg style="display:none;"><symbol id="copy-icon" viewBox="0 0 24 24"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" /></symbol></svg>',d+='<svg style="display:none;"><symbol id="switch-icon" viewBox="0 0 24 24"><path fill="currentColor" d="M21,3H3C1.89,3 1,3.89 1,5V17A2,2 0 0,0 3,19H8V21H16V19H21A2,2 0 0,0 23,17V5C23,3.89 22.1,3 21,3M21,17H3V5H21M16,11L9,15V7" /></symbol></svg>',d+='<svg style="display:none;"><symbol id="record-icon" viewBox="0 0 24 24"><path fill="currentColor" d="M12.5,5A7.5,7.5 0 0,0 5,12.5A7.5,7.5 0 0,0 12.5,20A7.5,7.5 0 0,0 20,12.5A7.5,7.5 0 0,0 12.5,5M7,10H9A1,1 0 0,1 10,11V12C10,12.5 9.62,12.9 9.14,12.97L10.31,15H9.15L8,13V15H7M12,10H14V11H12V12H14V13H12V14H14V15H12A1,1 0 0,1 11,14V11A1,1 0 0,1 12,10M16,10H18V11H16V14H18V15H16A1,1 0 0,1 15,14V11A1,1 0 0,1 16,10M8,11V12H9V11" /></symbol></svg>',d+="  </div>";let V,L=this.visTvprogram.getConfigFavorites(l);this.programdata[l][t].map(k=>{k.events.map(B=>{let j=this.visTvprogram.getDate(B.startTime,0),r=this.visTvprogram.channels.find(K=>K.id==B.channel);V=L.indexOf(B.title)>-1,d+='    <ul class="tv-row">',d+='       <li class="tv-item channel">',d+=`          <img width="100%" height="100%" data-channelid="${r.channelId}" data-dp="${l}" src="https://tvfueralle.de/channel-logos/${r.channelId}.png" alt="" class="channel-logo"  onclick="vis.binds.tvprogram.onclickChannelSwitch(this,event)">`,d+="       </li>",d+='       <li class="tv-item broadcast">',d+=`             <div class="broadcastelement ${V?"selected":""}" data-widgetid="${t}" data-eventid="${B.id}" data-viewdate="${j}" data-instance="${a}" data-dp="${l}" data-view="${e}" onclick="vis.binds.tvprogram.onclickBroadcast(this)">`,B.photo.url&&g&&(d+=`<div><img class="broadcastimage" src="https://tvfueralle.de${B.photo.url}"></div>`),d+='                 <div class="broadcasttitle">',d+=`                     ${B.title}`,d+=`                     <div class="star" data-viewdate="${j}" data-eventid="${B.id}" data-instance="${a}" data-dp="${l}" onclick="return vis.binds.tvprogram.onclickFavorite(this,event)"><svg width="100%" height="100%" ><use xlink:href="#star-icon"></use></svg></div>`,d+="                 </div>";let F=new Date(B.startTime),T=new Date(B.endTime);d+='                 <div class="broadcasttime">',d+=`${`0${F.getHours()}`.slice(-2)}:${`0${F.getMinutes()}`.slice(-2)}`,d+=" - ",d+=`${`0${T.getHours()}`.slice(-2)}:${`0${T.getMinutes()}`.slice(-2)}`,d+="                 </div>",d+="             </div>",d+="       </li>",d+="    </ul>"})}),$(`#${t} .tv-control`).html(d),this.timer[t]||clearInterval(this.timer[t]),this.timer[t]=setTimeout(()=>{vis.binds.tvprogram.control.createWidget(t,e,n,o)},1e3*60*5)})},parseTime:function(t){let e,n,o=new Date(t);if(o instanceof Date&&!isNaN(o))return o;if(t=="")return new Date;let i=t.split("/"),a=120;return i.length>1&&parseInt(i[1].trim())>0&&(a=parseInt(i[1].trim())),i=i[0].split(":"),n=new Date,n.setHours(parseInt(i[0])),n.setMinutes(parseInt(i[1])),n.setSeconds(0),e=new Date(n),n.setMinutes(n.getMinutes()+a),new Date<n?e:e.setDate(e.getDate()+1)},onChange:function(t,e,n,o,i,a,l){let c=a.type.split(".");(c[3]=="config"||c[3]=="favorites"||c[3]=="channelfilter"||c[3]=="show")&&c[4]=="val"&&(console.log(`changed ${t} type:${a.type} val:${l}`),this.tvprogram=[],this.createWidget(t,e,n,o))}},favorites:{visTvprogram:null,pending:{},bound:{},favorites:void 0,timer:{},createWidget:function(t,e,n,o){return R(this,null,function*(){let i=$(`#${t}`);if(!i.length)return setTimeout(function(){vis.binds.tvprogram.favorites.createWidget(t,e,n,o)},100);console.log("createWidget start"),this.visTvprogram=vis.binds.tvprogram;let a=n.tvprogram_showweekday||!1,l=n.tvprogram_maxfavorites||10,c=n.tvprogram_highlightcolor||"yellow",h=n.tvprogram_channelname||!1,u,p,f={weekday:"short"},b={month:"2-digit",day:"2-digit"},w={hour:"2-digit",minute:"2-digit"};if(!n.tvprogram_oid||(u=vis.binds.tvprogram.getTvprogramId(n.tvprogram_oid.trim()))==!1||!n.tvprogram_oid||(p=vis.binds.tvprogram.getInstance(n.tvprogram_oid.trim()))==!1)return;let g=this.visTvprogram.realBackgroundColor($(`#${t}`)[0]);this.visTvprogram.checkStyle("background-color",$(`#${t}`)[0].style.cssText)==""&&$(`#${t}`).css("background-color",g),this.bound[u]||(this.bound[u]={}),this.bound[u][t]||(this.bound[u][t]=!1),u&&!this.bound[u][t]&&(vis.editMode||(this.bound[u][t]=!0,vis.binds.tvprogram.bindStates(i,[`${u}.config`,`${u}.favorites`],this.onChange.bind(this,t,e,n,o,u))));let S=this.visTvprogram.getConfigFavorites(u);if(!this.favorites||!this.favorites[u]&&S){let d=yield this.visTvprogram.getFavoritesDataAsync(p,S);this.favorites||(this.favorites=[]),this.favorites[u]=d,this.createWidget(t,e,n,o)}if(!this.favorites||!this.favorites[u])return;let s="";s+=`<style> 
`,s+=`#${t} .tv-fav {
`,s+=`   width: 100%;
`,s+=`} 
`,s+=`#${t} .tv-fav td{
`,s+=`   white-space: nowrap;
`,s+=`} 
`,s+=`#${t} .tv-left {
`,s+=`   text-align: left;
`,s+=`   width: 1%;
`,s+=`} 
`,s+=`#${t} .tv-full {
`,s+=`   width: 50%;
`,s+=`} 
`,s+=`#${t} .tv-fav .star {
`,s+=`   width: 1em;
`,s+=`   height: 1em;
`,s+=`   color: ${c}; 
`,s+=`} 
`,s+=`#${t} .tv-center {
`,s+=`   text-align: center;
`,s+=`   width: 1%;
`,s+=`} 
`,s+=`#${t} .tv-icon {
`,s+=`   height: 1em; 
`,s+=`   width: 1em; 
`,s+=`} 
`,s+=`</style> 
`,s+='  <div class="svgcontainer">',s+='<svg style="display:none;"><symbol id="star-icon" viewBox="0 0 24 24"><path fill="currentColor" d="M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z" /></symbol></svg>',s+="  </div>",s+='<table class="tv-fav">',this.favorites[u]=this.favorites[u].filter(d=>new Date(d.endTime)>=new Date),this.favorites[u].forEach(function(d,V){let L=new Date,k=new Date(d.startTime),B=new Date(d.endTime);V<l&&(vis.binds.tvprogram.compareDate(L,k)?s+='        <tr class="tv-today">':s+="        <tr>",s+=`<td class="tv-left" data-viewdate="${d.viewdate}" data-eventid="${d.id}" data-instance="${p}" data-dp="${u}" onclick="return vis.binds.tvprogram.onclickFavorite(this,event)"><div class="star"><svg width="100%" height="100%" ><use xlink:href="#star-icon"></use></svg></div></td>`,a&&(s+=`           <td class="tv-left">${k.toLocaleString(vis.language,f)}</td>`),s+=`           <td class="tv-left">${k.toLocaleString(vis.language,b)}</td>`,s+=`           <td class="tv-left">${k.toLocaleString(vis.language,w)}</td>`,s+='           <td class="tv-left">-</td>',s+=`           <td class="tv-left">${B.toLocaleString(vis.language,w)}</td>`,h?s+=`           <td class="tv-left">${d.channelname}</td>`:(s+='           <td class="tv-center tv-tdicon">',s+=`              <img width="100%" height="100%" src="https://tvfueralle.de/channel-logos/${d.channelid}.png" alt="" class="tv-icon">`,s+="           </td>"),s+=`           <td class="tv-full">${d.title}</td>`,s+="        </tr>")}),s+="</table>            ",$(`#${t}`).html(s),this.timer[t]?(clearInterval(this.timer[t]),this.timer[t]=setInterval(vis.binds.tvprogram.favorites.createWidget.bind(this,t,e,n,o),1e3*60)):this.timer[t]=setInterval(vis.binds.tvprogram.favorites.createWidget.bind(this,t,e,n,o),1e3*60)})},onChange:function(t,e,n,o,i,a,l){let c=a.type.split(".");(c[3]=="config"||c[3]=="favorites"||c[3]=="channelfilter"||c[3]=="show")&&c[4]=="val"&&(console.log(`changed ${t} type:${a.type} val:${l}`),this.favorites=[],this.createWidget(t,e,n,o))}},time1:{visTvprogram:null,tvprogram:{},bound:{},timer:{},pending:{},measures:{},scroll:{},today:{},viewday:{},olddata:{},createWidget:function(t,e,n,o){return R(this,null,function*(){let i=$(`#${t}`);if(!i.length)return setTimeout(function(){vis.binds.tvprogram.time1.createWidget(t,e,n,o)},100);if(console.log(`createWidget start ${t}`),this.visTvprogram=vis.binds.tvprogram,!n.tvprogram_oid||n.tvprogram_oid=="")return;let[a,l]=this.visTvprogram.getInstanceInfo(n.tvprogram_oid);if(!l&&!a)return;let c=n.tvprogram_highlightcolor||"yellow";this.olddata[t]||(this.olddata[t]=n),(!this.measures[t]||JSON.stringify(this.olddata[t])!=JSON.stringify(n))&&(this.measures[t]={origwidthItem:parseInt(n.tvprogram_widthItem)||120,timeItem:30,heightRow:parseInt(n.tvprogram_heightRow)||35,scrollbarWidth:this.getScrollbarWidth(),markerpositionpercent:n.tvprogram_markerpositionpercent/100||.25,dialogwidthpercent:n.tvprogram_dialogwidthpercent/100||.9,dialogheightpercent:n.tvprogram_dialogheightpercent/100||.9,showpictures:n.tvprogram_showpictures||!1}),$(`#${t}broadcastdlg`).data({dialogwidthpercent:this.measures[t].dialogwidthpercent,dialogheightpercent:this.measures[t].dialogheightpercent}),this.measures[t].widthItem||(this.measures[t].widthItem=this.measures[t].origwidthItem),((this.today||{})[t]||{}).prevday||$(`#${t} .tv-container`).html("Datapoints loading..."),console.log("Load Data"),this.visTvprogram.categories||(this.visTvprogram.categories=yield this.visTvprogram.loadCategories(a,t)),this.visTvprogram.channels||(this.visTvprogram.channels=yield this.visTvprogram.loadChannels(a,t)),this.visTvprogram.genres||(this.visTvprogram.genres=yield this.visTvprogram.loadGenres(a,t));function h(T){return!T||Object.keys(T)==0}this.today[t]||(this.today[t]={today:new Date,prevday:null}),this.scroll[t]||(this.scroll[t]={time:new Date(0),position:0,marker:0,timeout:null,automatic:0}),console.log("Calc Date");let u=this.visTvprogram.calcDate(this.today[t].today),p=this.visTvprogram.getDate(u,0);this.viewday[t]||(this.viewday[t]={viewday:p,prevday:null}),this.viewday[t].viewday=p;let f=this.visTvprogram.getDate(u,0);if(h(this.tvprogram[p])&&(this.tvprogram[p]=yield this.visTvprogram.loadProgram(a,t,p)),this.visTvprogram.categories.length==0||this.visTvprogram.categories[0]==="request"||this.visTvprogram.channels.length==0||this.visTvprogram.channels[0]==="request"||this.visTvprogram.genres.length==0||this.visTvprogram.genres[0]==="request"||h(this.tvprogram[p]))return;this.viewday[t].viewday!=this.viewday[t].prevday&&(this.viewday[t].prevday=this.viewday[t].viewday),this.bound[l]||(this.bound[l]={}),this.bound[l][t]||(this.bound[l][t]=!1),l&&!this.bound[l][t]&&(vis.editMode||(this.bound[l][t]=!0,vis.binds.tvprogram.bindStates(i,[`${l}.config`,`${l}.cmd`,`${l}.favorites`,`${l}.channelfilter`,`${l}.show`],this.onChange.bind(this,t,e,n,o,a)))),this.onclickChannelSave.name=="onclickChannelSave"&&(this.onclickChannelSave=this.onclickChannelSave.bind(this)),console.log("Calc Channels");let b=this.visTvprogram.getConfigChannelfilter(l);b.length==0&&(b=this.visTvprogram.channels.reduce((T,K,J)=>(J<4&&T.push(K.id),T),[])),console.log("Calc styles");let w=this.measures[t].widthItem,g=this.measures[t].heightRow,S=this.measures[t].heightRow,s=this.visTvprogram.realBackgroundColor($(`#${t}`)[0]);this.visTvprogram.checkStyle("background-color",$(`#${t}`)[0].style.cssText)==""&&$(`#${t}`).css("background-color",s);let d=48*w+g,V=n.tvprogram_headerfontpercent||125,L=n.tvprogram_broadcastfontpercent||75,k=0,B=$(`#${t}`).height()-S,j=(b.length+1)*S;j<B?k=j:k=B-this.measures[t].scrollbarWidth,console.log(`Display day:${p}`),console.log("Output CSS");let r="";r+=`<style> 
`,r+=`#${t} * {
`,r+=`   box-sizing: border-box; 
`,r+=`} 
`,r+=`#${t} .tv-container {
`,r+=`   width: 100%; 
`,r+=`   height: 100%; 
`,r+=`   white-space:nowrap; 
`,r+=`   display:flex; 
`,r+=`   flex-direction: column; 
`,r+=`} 
`,r+=`#${t} .navcontainer {
`,r+=`   width: 100%; 
`,r+=`} 
`,r+=`#${t} .scrollcontainer {
`,r+=`   flex-grow: 1; 
`,r+=`   overflow:auto; 
`,r+=`   width:100%; 
`,r+=`} 
`,r+=`#${t} .tv-row {
`,r+=`   margin: 0px; 
`,r+=`   padding: 0px; 
`,r+=`   width: ${d}px; 
`,r+=`} 
`,r+=`#${t} .tv-item {
`,r+=`   display: inline-block; 
`,r+=`   vertical-align: middle; 
`,r+=`   border: solid #80808033; 
`,r+=`   border-width:1px 0px 0px 1px; 
`,r+=`} 
`,r+=`#${t} .tv-head-time {
`,r+=`   position:sticky; 
`,r+=`   position: -webkit-sticky; 
`,r+=`   top:0px; 
`,r+=`   z-index:11; 
`,r+=`   background-color: ${s}; 
`,r+=`} 
`,r+=`#${t} .tv-head-left {
`,r+=`   position:sticky; 
`,r+=`   position: -webkit-sticky; 
`,r+=`   left:0; 
`,r+=`   z-index:11; 
`,r+=`   background-color: ${s}; 
`,r+=`} 
`,r+=`#${t} svg rect {
`,r+=`   fill: ${$(`#${t}`).css("color")}; 
`,r+=`} 
`,r+=`#${t} .channel {
`,r+=`   width: ${S}px; 
`,r+=`   height: ${S}px; 
`,r+=`   padding: 1px; 
`,r+=`} 
`,r+=`#${t} .time {
`,r+=`   width: ${w}px; 
`,r+=`   height: ${S}px; 
`,r+=`   font-weight: 700; 
`,r+=`   font-size: ${V}%; 
`,r+=`   padding: 5px 5px; 
`,r+=`} 
`,r+=`#${t} .time:after {
`,r+=`   content:""; 
`,r+=`   display: inline-block; 
`,r+=`   vertical-align:middle; 
`,r+=`   height: 100%; 
`,r+=`} 
`,r+=`#${t} .time span {
`,r+=`   vertical-align:middle; 
`,r+=`} 
`,r+=`#${t} .broadcast {
`,r+=`   height: ${S}px; 
`,r+=`   padding: 3px; 
`,r+=`   font-size: ${L}%; 
`,r+=`   overflow: hidden; 
`,r+=`} 
`,r+=`#${t} .broadcastelement {
`,r+=`   width: 100%; 
`,r+=`   height: 100%; 
`,r+=`   display: table-cell; 
`,r+=`} 
`,r+=`#${t} .broadcastelement.hide {
`,r+=`   display: none; 
`,r+=`} 
`,r+=`#${t} .broadcastelement .star  {
`,r+=`   display: inline-block; 
`,r+=`   margin: 0px 2px; 
`,r+=`} 
`,r+=`#${t} .broadcastelement .star svg {
`,r+=`   height: 1em; 
`,r+=`   width: 1em; 
`,r+=`   position: relative; 
`,r+=`   top: .125em; 
`,r+=`} 
`,r+=`#${t}broadcastdlg .star.selected svg  {
`,r+=`   filter: drop-shadow( 2px 2px 2px rgba(0, 0, 0, .7))
`,r+=`} 
`,r+=`#${t} .broadcastelement.selected .star svg path, #${t}broadcastdlg .star.selected {
`,r+=`   color: ${c}; 
`,r+=`} 
`,r+=`#${t} .broadcastelement.selected {
`,r+=`   color: ${c}; 
`,r+=`   background-color: ${this.visTvprogram.colorToRGBA(c,".1")}; 
`,r+=`} 
`,r+=`#${t} .broadcastimage {
`,r+=`   height: ${S-7}px; 
`,r+=`   padding-right: 3px; 
`,r+=`   float: left; 
`,r+=`} 
`,r+=`#${t} .button {
`,r+=`   display:inline-block; 
`,r+=`   width: ${S}px; 
`,r+=`   height: ${S}px; 
`,r+=`   background-color: ${s}; 
`,r+=`   vertical-align: middle; 
`,r+=`   padding: 5px 5px; 
`,r+=`} 
`,r+=`#${t} .dateinfo {
`,r+=`   height: ${S}px; 
`,r+=`   padding: 5px 5px; 
`,r+=`   position: absolute; 
`,r+=`   right: 0px; 
`,r+=`   border: 0px; 
`,r+=`} 
`,r+=`#${t} .dateinfo:after {
`,r+=`   content:""; 
`,r+=`   display: inline-block; 
`,r+=`   vertical-align:middle; 
`,r+=`   height: 100%; 
`,r+=`} 
`,r+=`#${t} .dateinfo span {
`,r+=`   vertical-align:middle; 
`,r+=`} 
`,r+=`.ui-dialog.${t} {
`,r+=`   z-index:12; 
`,r+=`} 
`,r+=`.clearfix {
`,r+=`   clear:both; 
`,r+=`   content:""; 
`,r+=`   display:table; 
`,r+=`} 
`,r+=`#${t}channeldlg .chselect-container {
`,r+=`} 
`,r+=`#${t}channeldlg ul.channel {
`,r+=`   margin:0px; 
`,r+=`   padding:0px; 
`,r+=`} 
`,r+=`#${t}channeldlg .listitem  {
`,r+=`   float: left; 
`,r+=`} 
`,r+=`#${t}channeldlg .listitem .channel {
`,r+=`   list-style: none; 
`,r+=`} 
`,r+=`#${t}channeldlg .items  {
`,r+=`   list-style: none; 
`,r+=`   margin:0px; 
`,r+=`   padding:0px; 
`,r+=`} 
`,r+=`#${t}channeldlg .channel {
`,r+=`   margin:5px; 
`,r+=`   width: ${S*1.5}px; 
`,r+=`   height: ${S*1.5}px; 
`,r+=`   list-style: none; 
`,r+=`} 
`,r+=`#${t}channeldlg .items .channel[selected] {
`,r+=`   background-color:lightgray; 
`,r+=`} 
`,r+=`.${t}.no-titlebar .ui-dialog-titlebar {
`,r+=`   display:none; 
`,r+=`} 
`,r+=`#${t}broadcastdlg  {
`,r+=`   z-index:12; 
`,r+=`} 
`,r+=`#${t}broadcastdlg .event-container.tv-dlg-row {
`,r+=`   height:100%; 
`,r+=`   display:flex; 
`,r+=`   flex-direction:row; 
`,r+=`   overflow:hidden; 
`,r+=`} 
`,r+=`#${t}broadcastdlg .event-container.tv-dlg-col {
`,r+=`   height:100%; 
`,r+=`   display:flex; 
`,r+=`   flex-direction:column; 
`,r+=`   overflow:hidden; 
`,r+=`   font-size:75%; 
`,r+=`} 
`,r+=`#${t}broadcastdlg .event-picture.tv-dlg-row {
`,r+=`   width:50%; 
`,r+=`} 
`,r+=`#${t}broadcastdlg .event-picture.tv-dlg-col {
`,r+=`   height:30%; 
`,r+=`} 
`,r+=`#${t}broadcastdlg .event-data {
`,r+=`   overflow-y:auto; 
`,r+=`} 
`,r+=`#${t}broadcastdlg .event-picture img {
`,r+=`   width:auto; 
`,r+=`   height:auto; 
`,r+=`   max-width:100%; 
`,r+=`   max-height:100%; 
`,r+=`   display:block; 
`,r+=`   margin:auto; 
`,r+=`} 
`,r+=`#${t}broadcastdlg .event-picture img {
`,r+=`   width:auto; 
`,r+=`   height:auto; 
`,r+=`   max-width:100%; 
`,r+=`   max-height:100%; 
`,r+=`   display:block; 
`,r+=`   margin:auto; 
`,r+=`} 
`,r+=`#${t}broadcastdlg .dialogcolumn.tv-dlg-row {
`,r+=`   flex:1; 
`,r+=`   padding:5px; 
`,r+=`} 
`,r+=`#${t}broadcastdlg .dialogcolumn.tv-dlg-col {
`,r+=`   padding:5px; 
`,r+=`} 
`,r+=`#${t}broadcastdlg .button {
`,r+=`   display:inline-block; 
`,r+=`   width: 35px; 
`,r+=`   height: 35px; 
`,r+=`   vertical-align: middle; 
`,r+=`   position: relative; 
`,r+=`   float: right; 
`,r+=`} 
`,r+=`#${t} .tooltip {
`,r+=`   position: relative; 
`,r+=`} 
`,r+=`#${t} .tooltip span[role=tooltip] {
`,r+=`   display: none; 
`,r+=`} 
`,r+=`#${t} .tooltip:hover span[role=tooltip] {
`,r+=`   display: block; 
`,r+=`   position: absolute; 
`,r+=`   left: 3em; 
`,r+=`   border: 1px solid; 
`,r+=`   font-size: 75%; 
`,r+=`   padding: 0.2em; 
`,r+=`   z-index: 100; 
`,r+=`   background-color: ${s}; 
`,r+=`} 
`,r+=`#${t} .scrollcontainer ul.tv-row:nth-child(odd)> li.broadcast:nth-child(odd),#${t} ul.tv-row:nth-child(odd)> li.time:nth-child(odd) {
`,r+=`   background-color: rgba(128, 128, 128, 0.65); 
`,r+=`} 
`,r+=`#${t} .scrollcontainer ul.tv-row:nth-child(odd)> li.broadcast:nth-child(even),#${t} ul.tv-row:nth-child(odd)> li.time:nth-child(even) {
`,r+=`   background-color: rgba(128, 128, 128, 0.55); 
`,r+=`} 
`,r+=`#${t} .scrollcontainer ul.tv-row:nth-child(even)> li.broadcast:nth-child(odd) {
`,r+=`   background-color: rgba(128, 128, 128, 0.45); 
`,r+=`} 
`,r+=`#${t} .scrollcontainer ul.tv-row:nth-child(even)> li.broadcast:nth-child(even) {
`,r+=`   background-color: rgba(128, 128, 128, 0.35); 
`,r+=`} 
`,r+=`#${t} .line {
`,r+=`   position: absolute; 
`,r+=`   top: 0; 
`,r+=`   width: 2px; 
`,r+=`   background-color: red; 
`,r+=`   opacity: 0.8; 
`,r+=`   z-index: 10; 
`,r+=`   height: ${k}px; 
`,r+=`   float: left; 
`,r+=`} 
`,r+=`#${t} .disable-select {
`,r+=`   -webkit-user-select: none; 
`,r+=`   -moz-user-select: none; 
`,r+=`   -ms-user-select: none; 
`,r+=`   -user-select: none; 
`,r+=`} 
`,r+=`#${t} .staricon {
`,r+=`     background-image: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='100%' height='100%' viewBox='0 0 24 24'><path fill='currentColor' d='M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z' /></svg>"); 
`,r+=`} 
`,r+=`</style> 
`,console.log("Output SVG"),r+='  <div class="svgcontainer">',r+='<svg style="display:none;"><symbol id="star-icon" viewBox="0 0 24 24"><path fill="currentColor" d="M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z" /></symbol></svg>',r+='<svg style="display:none;"><symbol id="check-icon" viewBox="0 0 24 24"><path fill="currentColor" d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"></path></symbol></svg>',r+='<svg style="display:none;"><symbol id="cancel-icon" viewBox="0 0 24 24"><path fill="currentColor" d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></symbol></svg>',r+='<svg style="display:none;"><symbol id="copy-icon" viewBox="0 0 24 24"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" /></symbol></svg>',r+='<svg style="display:none;"><symbol id="switch-icon" viewBox="0 0 24 24"><path fill="currentColor" d="M21,3H3C1.89,3 1,3.89 1,5V17A2,2 0 0,0 3,19H8V21H16V19H21A2,2 0 0,0 23,17V5C23,3.89 22.1,3 21,3M21,17H3V5H21M16,11L9,15V7" /></symbol></svg>',r+='<svg style="display:none;"><symbol id="burger-icon" viewBox="0 0 24 24"><path fill="currentColor" d="M3,6H21V8H3V6M3,11H21V13H3V11M3,16H21V18H3V16Z"></path></symbol></svg>',r+='<svg style="display:none;"><symbol id="nav-prevD-icon" viewBox="0 0 24 24"><path fill="currentColor" d="M20,9V15H12V19.84L4.16,12L12,4.16V9H20Z" /></symbol></svg>',r+='<svg style="display:none;"><symbol id="nav-center-icon" viewBox="0 0 24 24"><path fill="currentColor" d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9Z" /></symbol></svg>',r+='<svg style="display:none;"><symbol id="nav-nextD-icon" viewBox="0 0 24 24"><path fill="currentColor" d="M4,15V9H12V4.16L19.84,12L12,19.84V15H4Z" /></symbol></svg>',r+='<svg style="display:none;"><symbol id="zoom-minus-icon" viewBox="0 0 24 24"><path fill="currentColor" d="M15.5,14H14.71L14.43,13.73C15.41,12.59 16,11.11 16,9.5A6.5,6.5 0 0,0 9.5,3A6.5,6.5 0 0,0 3,9.5A6.5,6.5 0 0,0 9.5,16C11.11,16 12.59,15.41 13.73,14.43L14,14.71V15.5L19,20.5L20.5,19L15.5,14M9.5,14C7,14 5,12 5,9.5C5,7 7,5 9.5,5C12,5 14,7 14,9.5C14,12 12,14 9.5,14M7,9H12V10H7V9Z" /></symbol></svg>',r+='<svg style="display:none;"><symbol id="zoom-center-icon" viewBox="0 0 24 24"><path fill="currentColor" d="M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M19,19H15V21H19A2,2 0 0,0 21,19V15H19M19,3H15V5H19V9H21V5A2,2 0 0,0 19,3M5,5H9V3H5A2,2 0 0,0 3,5V9H5M5,15H3V19A2,2 0 0,0 5,21H9V19H5V15Z" /></symbol></svg>',r+='<svg style="display:none;"><symbol id="zoom-plus-icon" viewBox="0 0 24 24"><path fill="currentColor" d="M15.5,14L20.5,19L19,20.5L14,15.5V14.71L13.73,14.43C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.43,13.73L14.71,14H15.5M9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14M12,10H10V12H9V10H7V9H9V7H10V9H12V10Z" /></symbol></svg>',r+='<svg style="display:none;"><symbol id="record-icon" viewBox="0 0 24 24"><path fill="currentColor" d="M12.5,5A7.5,7.5 0 0,0 5,12.5A7.5,7.5 0 0,0 12.5,20A7.5,7.5 0 0,0 20,12.5A7.5,7.5 0 0,0 12.5,5M7,10H9A1,1 0 0,1 10,11V12C10,12.5 9.62,12.9 9.14,12.97L10.31,15H9.15L8,13V15H7M12,10H14V11H12V12H14V13H12V14H14V15H12A1,1 0 0,1 11,14V11A1,1 0 0,1 12,10M16,10H18V11H16V14H18V15H16A1,1 0 0,1 15,14V11A1,1 0 0,1 16,10M8,11V12H9V11" /></symbol></svg>',r+='<svg style="display:none;"><symbol id="hide-icon" viewBox="0 0 24 24"><path fill="currentColor" d="M2,5.27L3.28,4L20,20.72L18.73,22L15.65,18.92C14.5,19.3 13.28,19.5 12,19.5C7,19.5 2.73,16.39 1,12C1.69,10.24 2.79,8.69 4.19,7.46L2,5.27M12,9A3,3 0 0,1 15,12C15,12.35 14.94,12.69 14.83,13L11,9.17C11.31,9.06 11.65,9 12,9M12,4.5C17,4.5 21.27,7.61 23,12C22.18,14.08 20.79,15.88 19,17.19L17.58,15.76C18.94,14.82 20.06,13.54 20.82,12C19.17,8.64 15.76,6.5 12,6.5C10.91,6.5 9.84,6.68 8.84,7L7.3,5.47C8.74,4.85 10.33,4.5 12,4.5M3.18,12C4.83,15.36 8.24,17.5 12,17.5C12.69,17.5 13.37,17.43 14,17.29L11.72,15C10.29,14.85 9.15,13.71 9,12.28L5.6,8.87C4.61,9.72 3.78,10.78 3.18,12Z" /></symbol></svg>',r+="  </div>",console.log("Output Navigation"),r+='  <div class="navcontainer">',r+='    <ul class="tv-row tv-head-top">',r+=this.getButtonHeader(p).join(""),r+="    </ul>",r+="  </div>",console.log("Output tvprogram"),r+='  <div class="scrollcontainer">',r+='    <ul class="tv-row tv-head-time">',r+='      <div class="line"></div>',r+='      <li class="tv-item tv-head-left channel">',r+="      </li>",r+=this.getTimetable().join(""),r+="    </ul>",this.getEvents(this.tvprogram[f],b).map(T=>{r+='    <ul class="tv-row">',r+=this.getBroadcasts4Channel(T,t,e,f,l,a).join(""),r+="    </ul>"}),$(`#${t} .tv-container`).html(r),this.visTvprogram.getConfigShow(l)==1?$(`#${t} .broadcastelement:not(".selected") > *`).show():$(`#${t} .broadcastelement:not(".selected") > *`).hide(),console.log("Connect Buttone events"),$(`#${t} .burger`).click(function(T,K,J,C){vis.binds.tvprogram.time1.onclickChannel(T,J,K,C)}.bind(this,t,l,a)),$(`#${t} .button.nav.prevD`).off("click.onClickDay").on("click.onClickDay",this.onClickDay.bind(this,t,e,n,o)),$(`#${t} .button.nav.nextD`).off("click.onClickDay").on("click.onClickDay",this.onClickDay.bind(this,t,e,n,o)),$(`#${t} .button.nav.center`).off("click.onClickDay").on("click.onClickDay",this.onClickDay.bind(this,t,e,n,o)),$(`#${t} .button.zoom.minus`).off("click.onClickZoom").on("click.onClickZoom",this.onClickZoom.bind(this,t,e,n,o)),$(`#${t} .button.zoom.plus`).off("click.onClickZoom").on("click.onClickZoom",this.onClickZoom.bind(this,t,e,n,o)),$(`#${t} .button.zoom.center`).off("click.onClickZoom").on("click.onClickZoom",this.onClickZoom.bind(this,t,e,n,o)),$(`#${t} .button.hide`).off("click.onClickHide").on("click.onClickHide",this.onClickHide.bind(this,a,l,t)),$(`#${t} .scrollcontainer`).scroll(function(T){this.scroll[T].automatic==0&&(this.scroll[T].automatic=2),this.scroll[T].time=new Date,this.calcScroll(T)}.bind(this,t)),this.visTvprogram.copyStyles("font",$(`#${t}`).get(0),$(`#${t}broadcastdlg`).get(0)),this.visTvprogram.copyStyles("color",$(`#${t}`).get(0),$(`#${t}broadcastdlg`).get(0)),this.visTvprogram.copyStyles("background-color",$(`#${t}`).get(0),$(`#${t}broadcastdlg`).get(0)),this.updateMarker(t,this.today[t].today),this.timer[t]?(clearInterval(this.timer[t]),this.timer[t]=setInterval(this.updateMarker.bind(this,t,this.today[t].today),15e3)):this.timer[t]=setInterval(this.updateMarker.bind(this,t,this.today[t].today),15e3),this.scroll[t].position==0?(this.calcScroll(t),this.setScroll(t)):this.setScroll(t),console.log("Output done")})},onClickHide:function(t,e){this.visTvprogram.toggleShow(t,e)},onClickZoom:function(t,e,n,o,i){$(i.currentTarget).hasClass("plus")&&(this.measures[t].widthItem=this.measures[t].widthItem+this.measures[t].origwidthItem/4,console.log("Click Zoom plus")),$(i.currentTarget).hasClass("minus")&&(this.measures[t].widthItem=this.measures[t].widthItem-this.measures[t].origwidthItem/4,console.log("Click Zoom minus")),$(i.currentTarget).hasClass("center")&&(this.measures[t].widthItem=this.measures[t].origwidthItem,console.log("Click Zoom center")),this.measures[t].widthItem<20&&(this.measures[t].widthItem=this.measures[t].origwidthItem,console.log("Click Zoom Max zoom reached, reset")),this.calcScroll(t),this.createWidget(t,e,n,o)},onClickDay:function(t,e,n,o,i){console.log(`ClickNav:${$(i.currentTarget).attr("class")}`);let a=0;$(i.currentTarget).hasClass("prevD")&&(a=-1),$(i.currentTarget).hasClass("nextD")&&(a=1);let l=re(this.today[t].today).add(a,"day"),c=re(l).diff(re(),"day");$(i.currentTarget).hasClass("center")?(this.today[t].today=new Date,this.scroll[t].position=0):c>-5&&c<5&&(this.today[t].prevday=new Date(this.today[t].today),this.today[t].today=l.toDate(),console.log(`Navigate to date: ${re(l).format()}`)),this.scroll[t].time=new Date(0),this.createWidget(t,e,n,o)},calcScroll:function(t){let e=$(`#${t} .scrollcontainer`).get(0);e&&(e.scrollLeft==0||this.scroll[t].position==0?this.scroll[t].position=this.scroll[t].marker/e.scrollWidth:this.scroll[t].position=(e.scrollLeft+e.clientWidth*this.measures[t].markerpositionpercent)/e.scrollWidth)},setScroll:function(t){try{let e=$(`#${t} .scrollcontainer`).get(0);if(!e.scrollWidth)return;e.scrollLeft=this.scroll[t].position*e.scrollWidth-e.clientWidth*this.measures[t].markerpositionpercent}catch(e){console.log(e)}},updateMarker:function(t,e){if(this.scroll[t].automatic==2&&new Date-this.scroll[t].time<90*1e3)return;this.scroll[t].automatic=0,this.visTvprogram.calcDate(e).toLocaleDateString()!=this.visTvprogram.calcDate(new Date).toLocaleDateString()?$(`#${t} .line`).hide():$(`#${t} .line`).show();let n=this.measures[t].widthItem,o=this.measures[t].timeItem,i=this.measures[t].heightRow,a=new Date(this.visTvprogram.calcDate(new Date));a.setHours(5),a.setMinutes(0),a.setSeconds(0);let l=new Date(a);l.setDate(l.getDate()+1);let h=i+Math.floor((new Date-a)/6e4/o*n*10)/10;$(`#${t} .line`).css("left",`${h}px`),this.scroll[t].marker=h,this.scroll[t].position=0,this.calcScroll(t),this.scroll[t].timeout&&clearTimeout(this.scroll[t].timeout),this.scroll[t].automatic=1,this.scroll[t].timeout=window.setTimeout(function(){this.scroll[t].automatic=0,clearTimeout(this.scroll[t].timeout),this.scroll[t].timeout=null}.bind(this),500),this.setScroll(t)},getScrollbarWidth:function(){let t=document.createElement("div");t.className="scrollbar-measure",t.style.cssText="width: 100px;height: 100px;overflow: scroll;position: absolute;top: -9999px;",document.body.appendChild(t);let e=t.offsetWidth-t.clientWidth;return document.body.removeChild(t),e},getChannels:function(t,e=[]){let n=[];return e.map(o=>{let i=t.find(a=>a.id==o);n.push(`<li class="listitem channel" data-order="${i.order}" data-id="${i.id}" selected><img width="100%" height="100%" src="https://tvfueralle.de/channel-logos/${i.channelId}.png" alt="" class="channel-logo"></li>`)}),t.sort((o,i)=>o.order+(e.indexOf(o.id)==-1)*1e5-(i.order+(e.indexOf(i.id)==-1)*1e5)).map(o=>{e.findIndex(i=>i==o.id)==-1&&n.push(`<li class="listitem channel" data-order="${o.order}" data-id="${o.id}"><img width="100%" height="100%" src="https://tvfueralle.de/channel-logos/${o.channelId}.png" alt="" class="channel-logo"></li>`)}),n},onclickChannelSave:function(t,e){let n=t.dataset.widgetid;if(e){let i=t.dataset.dp||"",a=t.dataset.instance||"";this.visTvprogram.setConfigChannelfilter(a,i,$(`#${n}channeldlg .chselect-container .channel[selected]`).toArray().map(l=>parseInt(l.dataset.id)))}document.querySelector(`#${n}channeldlg dialog`).close()},onclickChannel:function(t,e,n){let o=!1,i=this.visTvprogram.channels,a=this.visTvprogram.getConfigChannelfilter(n);a.length==0&&(a=i.reduce((S,s,d)=>(d<4&&S.push(s.id),S),[]));let l=$(`#${t}`).width()*this.measures[t].dialogwidthpercent,c=$(`#${t}`).height()*this.measures[t].dialogheightpercent,{top:h,left:u}=$(`#${t}`).position(),p=h+($(`#${t}`).height()-c)/2,f=u+($(`#${t}`).width()-l)/2,b="";b+=`<dialog class="${t}broadcastdialog" style="margin:0;width:${l}px;height:${c}px;top:${p}px;left:${f}px">`,b+='  <div class="chselect-container clearfix">',b+=`    <ul class="listitem channel" data-instance="${e}" data-dp="${n}" data-widgetid="${t}" onclick="vis.binds.tvprogram.time1.onclickChannelSave(this,true)" ><li class="channel"><svg width="100%" height="100%" ><use xlink:href="#check-icon"></use></svg></li></ul>`,b+=`    <ul class="listitem channel" data-widgetid="${t}" onclick="vis.binds.tvprogram.time1.onclickChannelSave(this,false)"><li class="channel"><svg width="100%" height="100%" ><use xlink:href="#cancel-icon"></use></svg></li></ul>`,b+="  </div>",b+='  <div class="chselect-container clearfix sortable">',b+='  <ul class="items">',b+=this.getChannels(i,a).join(`
`),b+="  </ul>",b+="  </div>",$(`#${t}channeldlg`).html(b),$(".chselect-container .items .channel").click(function(){if(console.log("channel click"),o)return;let S=$(this).parent().find("[selected]").last();this.dataset.id&&($(this).attr("selected")?$(this).removeAttr("selected"):$(this).attr("selected","")),$(this).attr("selected")?$(this).insertAfter(S):$(this).parent().children().sort(function(s,d){return s.dataset.order+($(s).attr("selected")!="selected")*1e5-(d.dataset.order+($(d).attr("selected")!="selected")*1e5)}).appendTo($(this).parent())});let w=document.querySelector(".chselect-container.sortable .items");new Qe(w,{animation:150,filter:"li:not([selected])",onMove:function(S){if(!S.related.hasAttribute("selected"))return!1}}),this.visTvprogram.copyStyles("font",$(`#${t}`).get(0),$(`#${t}channeldlg`).get(0)),this.visTvprogram.copyStyles("color",$(`#${t}`).get(0),$(`#${t}channeldlg`).get(0)),this.visTvprogram.copyStyles("background-color",$(`#${t}`).get(0),$(`#${t}channeldlg`).get(0)),document.querySelector(`#${t}channeldlg dialog`).showModal()},getBroadcasts4Channel:function(t,e,n,o,i,a){let l=this.measures[e].widthItem,c=this.measures[e].timeItem,h=this.visTvprogram.getConfigFavorites(i),u,p=new Date(t.events[0].airDate);p.setHours(5),p.setMinutes(0);let f=new Date(p);f.setDate(f.getDate()+1);let b=this.visTvprogram.channels.find(d=>d.id==t.channel),w=[],g="";g+='    <li class="tv-item tv-head-left channel">',g+=`      <img width="100%" height="100%" data-instance="${a}" data-channelid="${b.channelId}" data-dp="${i}" src="https://tvfueralle.de/channel-logos/${b.channelId}.png" alt="" class="channel-logo"  onclick="vis.binds.tvprogram.onclickChannelSwitch(this,event)">`,g+="    </li>",w.push(g);for(let d=0;d<t.events.length;d++){let V=t.events[d],L=new Date(V.startTime),k=new Date(V.endTime);L>=f||k<=p||(d==0&&L>p&&w.push(`<li class="tv-item broadcast" style="left:0px; width:${Math.floor((L-p)/6e4/c*l*10)/10}px;"></li>`),L<p&&(L=p),k>f&&(k=f),u=h.indexOf(V.title)>-1,g="",g+='<li class="tv-item broadcast" style="',g+=`left:${Math.floor((L-p)/6e4/c*l*10)/10}px;`,g+=`width:${Math.floor((k-L)/6e4/c*l*10)/10}px;">`,g+=`<div class="broadcastelement ${u?"selected":""}" data-widgetid="${e}" data-eventid="${V.id}" data-viewdate="${o}" data-instance="${a}" data-dp="${i}" data-view="${n}" onclick="vis.binds.tvprogram.onclickBroadcast(this)">`,V.photo.url&&this.measures[e].showpictures&&(g+=`<div><img class="broadcastimage" src="https://tvfueralle.de${V.photo.url}"></div>`),g+=`<div class="broadcasttitle">${V.title}`,g+=`<div class="star" data-viewdate="${o}" data-eventid="${V.id}" data-dp="${i}" data-instance="${a}" onclick="return vis.binds.tvprogram.onclickFavorite(this,event)"><svg width="100%" height="100%" ><use xlink:href="#star-icon"></use></svg></div>`,g+="</div>",g+='<div class="broadcasttime">',g+=`${`0${L.getHours()}`.slice(-2)}:${`0${L.getMinutes()}`.slice(-2)}`,g+=" - ",g+=`${`0${k.getHours()}`.slice(-2)}:${`0${k.getMinutes()}`.slice(-2)}`,g+="</div></div></li>",w.push(g))}let S=new Date(t.events[t.events.length-1].startTime),s=new Date(t.events[t.events.length-1].endTime);return S<f&&s<f&&(S=s,s=f,g="",g+='<li class="tv-item broadcast" style="',g+=`left:${Math.floor((S-p)/6e4/c*l*10)/10}px;`,g+=`width:${Math.floor((s-S)/6e4/c*l*10)/10}px;">`,g+="</li>",w.push(g)),w},getEvents:function(t,e){let n=[],o;return t.map(i=>{(o=e.indexOf(i.channel))>-1&&(n[o]||(n[o]={}),n[o].events||(n[o].events=[]),n[o].channel=i.channel,n[o].events.push(i))}),n},getTimetable:function(){let t=[];for(let e=0;e<24;e++)t.push(`<li class="tv-item time"><span>${`0${e}`.slice(-2)}:00</span></li>`),t.push(`<li class="tv-item time"><span>${`0${e}`.slice(-2)}:30</span></li>`);return[].concat(t.slice(10),t.slice(0,10))},getButtonHeader:function(t){let e=[];return e.push('<li class="tv-item tv-head-topleft tv-head-left button burger tooltip"><span role="tooltip">Menu</span><svg width="100%" height="100%" ><use xlink:href="#burger-icon"></use></svg></li>'),e.push('<li class="tv-item button nav prevD tooltip"><span role="tooltip">Previous day</span><svg width="100%" height="100%" ><use xlink:href="#nav-prevD-icon"></use></svg></li>'),e.push('<li class="tv-item button nav center tooltip"><span role="tooltip">Today</span><svg width="100%" height="100%" ><use xlink:href="#nav-center-icon"></use></svg></li>'),e.push('<li class="tv-item button nav nextD tooltip"><span role="tooltip">Next day</span><svg width="100%" height="100%" ><use xlink:href="#nav-nextD-icon"></use></svg></li>'),e.push('<li class="tv-item button zoom minus tooltip"><span role="tooltip">Zoom in</span><svg width="100%" height="100%" ><use xlink:href="#zoom-minus-icon"></use></svg></li>'),e.push('<li class="tv-item button zoom center tooltip"><span role="tooltip">Zoom normal</span><svg width="100%" height="100%" ><use xlink:href="#zoom-center-icon"></use></svg></li>'),e.push('<li class="tv-item button zoom plus tooltip"><span role="tooltip">Zoom out</span><svg width="100%" height="100%" ><use xlink:href="#zoom-plus-icon"></use></svg></li>'),e.push('<li class="tv-item button hide tooltip"><span role="tooltip">Hide Non-Favorites</span><svg width="100%" height="100%" ><use xlink:href="#hide-icon"></use></svg></li>'),e.push(`<li class="tv-item dateinfo">${new Date(t).toLocaleDateString(navigator.language,{weekday:"short"})}, ${new Date(t).toLocaleDateString()}</li>`),e},onChange:function(t,e,n,o,i,a,l){return R(this,null,function*(){let c=a.type.split(".");if((c[3]=="config"||c[3]=="favorites"||c[3]=="channelfilter"||c[3]=="show")&&c[4]=="val"&&(console.log(`changed ${t} type:${a.type} val:${l}`),this.createWidget(t,e,n,o)),c[3]=="cmd"&&c[4]=="val"&&l&&l!=""){console.log(`changed ${t} type:${a.type} val:${l}`);let h=l.split("|");if(h[0]=="new"){if(h[1]!="program"){this[h[1]]=yield this.visTvprogram.getServerDataAsync(i,t,h[1]),this.createWidget(t,e,n,o);return}h[1]=="program"&&this.tvprogram[h[2]]&&this.visTvprogram.loadProgram(i,t,h[2],function(u,p,f,b,w,g){if(g!="error"&&g!="nodata"){this.tvprogram[w]=g,this.createWidget(u,p,f,b);return}}.bind(this,t,e,n,o,h[2]))}}})}},checkStyle:function(t,e){return e.split(";").reduce((n,o)=>o.split(":")[0].trim()==t?o.split(":")[1].trim():n,"")},realBackgroundColor:function(t){let e="rgba(0, 0, 0, 0)",n="transparent";if(!t)return e;let o=window.getComputedStyle(t).backgroundColor;return o===e||o===n?this.realBackgroundColor(t.parentElement):o},onclickBroadcast:function(t){return R(this,null,function*(){let e=t.currentTarget?t.currentTarget:t,n=e.dataset.eventid||0,o=e.dataset.widgetid||0,i=e.dataset.viewdate||0,a=e.dataset.instance||"",l=e.dataset.dp||"";if(n==0||o==0)return;let c=yield this.getServerBroadcastAsync(a,n,i),h=$(`#${o}broadcastdlg`).data(),u=new Date(c.startTime),p=new Date(c.endTime),f=c.content.category?this.categories.find(v=>v.id==c.content.category):null,b=c.channel?this.channels.find(v=>v.id==c.channel):null,w="";w+=b?`${b.name} `:"",w+=`${`0${u.getHours()}`.slice(-2)}:${`0${u.getMinutes()}`.slice(-2)}`,w+=" - ",w+=`${`0${p.getHours()}`.slice(-2)}:${`0${p.getMinutes()}`.slice(-2)}`;let g="";g+=c.content.country?`${c.content.country} `:"",g+=c.content.year?`${c.content.year} `:"",g+=f?`${f.title} `:"";let S="",s="";c.content.seasonNumber&&(S=c.content.seasonNumber,S=S<100?`S${`0${S}`.slice(-2)}`:`S${S}`),c.content.episodeNumber&&(s=c.content.episodeNumber,s=s<100?`E${`0${s}`.slice(-2)}`:`E${s}`),g+=S||s?`${S+s} `:"";let d=c.content.texts.Long.value?c.content.texts.Long.value:c.content.texts.VeryShort.value?c.content.texts.VeryShort.value:"",V=c.photo.url?`https://tvfueralle.de${c.photo.url}`:"https://tvfueralle.de/tv-logo-no-image.svg",k=this.getConfigFavorites(l).indexOf(c.title)>-1,B=$(`#${o}`).width()*h.dialogwidthpercent>$(`#${o}`).height()*h.dialogheightpercent?" tv-dlg-row":" tv-dlg-col",j=$(`#${o}`).width()*h.dialogwidthpercent,r=$(`#${o}`).height()*h.dialogheightpercent,{top:F,left:T}=$(`#${o}`).position(),K=F+($(`#${o}`).height()-r)/2,J=T+($(`#${o}`).width()-j)/2,C="";C+=`<dialog class="${o}broadcastdialog" style="margin:0;width:${j}px;height:${r}px;top:${K}px;left:${J}px">`,C+=`  <div class="event-container${B}" data-eventid="${c.id}">`,C+=`    <div class="event-picture dialogcolumn${B}">`,C+=`    <img src="${V}">`,C+="    </div>",C+=`    <div class="event-data dialogcolumn${B}">`,C+='      <div class="buttoncontainer">',C+=`          <div class="record button" data-viewdate="${i}" data-eventid="${c.id}" data-instance="${a}" data-dp="${l}" onclick="return vis.binds.tvprogram.onclickRecord(this,event)"><svg width="100%" height="100%" ><use xlink:href="#record-icon"></use></svg></div>`,C+=`          <div class="copy button" data-widgetid="${o}" onclick="return vis.binds.tvprogram.onclickCopy(this,event)"><svg width="100%" height="100%" ><use xlink:href="#copy-icon"></use></svg></div>`,C+=`          <div class="star button ${k?"selected":""}" data-viewdate="${i}" data-eventid="${c.id}" data-instance="${a}" data-dp="${l}" onclick="return vis.binds.tvprogram.onclickFavorite(this,event)"><svg width="100%" height="100%" ><use xlink:href="#star-icon"></use></svg></div>`,u<new Date&&new Date<p&&(C+=`        <div class="channelselect button" data-instance="${a}" data-dp="${l}" data-channelid="${b.channelId}" onclick="vis.binds.tvprogram.onclickChannelSwitch(this,event)"><svg width="100%" height="100%" ><use xlink:href="#switch-icon"></use></svg></div>`),C+="      </div>",C+=`      <div style="padding: 0px 0px 5px;">${w}</div>`,C+=`      <div style="font-weight: bold;padding: 0px 0px 5px;">${c.title}</div>`,C+=`      <div style="padding: 0px 0px 5px;">${g}</div>`,C+=`      <div>${d}</div>`,C+="    </div>",C+="  </div>",C+="  </div>",C+='</dialog">',$(`#${o}broadcastdlg`).html(C),this.copyStyles("font",$(`#${o}`).get(0),$(`#${o}broadcastdlg dialog`).get(0)),this.copyStyles("color",$(`#${o}`).get(0),$(`#${o}broadcastdlg dialog`).get(0)),this.copyStyles("background-color",$(`#${o}`).get(0),$(`#${o}broadcastdlg dialog`).get(0));let y=document.querySelector(`#${o}broadcastdlg dialog`);$(`#${o}broadcastdlg`).click(function(){y.close()}),y.showModal()})},onclickRecord:function(t,e){return R(this,null,function*(){let n=t.dataset.instance||"",o=t.dataset.dp||"",i=t.dataset.eventid||0,a=t.dataset.viewdate||0;if(i==0||a==0)return;e.stopPropagation();let l=yield this.getServerBroadcastAsync(n,i,a),c=l.channel?this.channels.find(u=>u.id==l.channel):null,h={startTime:l.startTime,endTime:l.endTime,title:l.title,channel:l.channel,channelid:c.channelId,channelname:c.name,eventid:l.id};this.setValueAckAsync(n,`${o}.record`,JSON.stringify(h))})},onclickCopy:function(t,e){let n=t.dataset.widgetid||"",o=document.createElement("textarea");o.value=$(`#${n}broadcastdlg .event-data`).get(0).outerText,document.body.appendChild(o),o.focus(),o.select(),document.execCommand("copy"),document.body.removeChild(o),e.stopPropagation()},copyStyles:function(t,e,n){let o=window.getComputedStyle(e),i=window.getComputedStyle(n);for(let a=o.length;a--;)o[a].startsWith(t)&&o.getPropertyValue(o[a])!=i.getPropertyValue(o[a])&&n.style.setProperty(o[a],o.getPropertyValue(o[a]))},colorToRGBA:function(t,e=1){let n=document.createElement("canvas");n.height=1,n.width=1;let o=n.getContext("2d");o.fillStyle=t,o.fillRect(0,0,1,1);let i=o.getImageData(0,0,1,1).data;return`rgba(${i[0]},${i[1]},${i[2]},${e})`},onclickChannelSwitch:function(t,e){let n=t.dataset.channelid||"",o=t.dataset.dp||"",i=t.dataset.instance||"";this.setValueAckAsync(i,`${o}.selectchannel`,n),e.stopPropagation()},onclickFavorite:function(t,e){return R(this,null,function*(){let n=t.dataset.dp||"",o=t.dataset.instance||"",i=t.dataset.eventid||0,a=t.dataset.viewdate||0;if(e.stopPropagation(),i==0||a==0)return;let l=yield this.getServerBroadcastAsync(o,i,a),c=this.getConfigFavorites(n),h=c.indexOf(l.title);h>-1?(c.splice(h,1),$(t).hasClass("button")&&$(t).removeClass("selected")):(c.push(l.title),$(t).hasClass("button")&&$(t).addClass("selected")),this.setConfigFavorites(o,n,c)})},getConfig:function(t){let e,n=vis.states.attr(`${t}.config.val`);return typeof n!="undefined"&&n!=="null"&&n!==""?e=JSON.parse(n):e={},e},getConfigFavorites:function(t){let e,n=vis.states.attr(`${t}.favorites.val`);return typeof n!="undefined"&&n!=="null"&&n!==""?e=JSON.parse(n):e=[],e},setConfigFavorites:function(t,e,n){this.setValueAckAsync(t,`${e}.favorites`,JSON.stringify(n))},getConfigChannelfilter:function(t){let e,n=vis.states.attr(`${t}.channelfilter.val`);return typeof n!="undefined"&&n!=="null"&&n!==""?e=JSON.parse(n):e=[],e},setConfigChannelfilter:function(t,e,n){this.setValueAckAsync(t,`${e}.channelfilter`,JSON.stringify(n))},getConfigShow:function(t){let e,n=vis.states.attr(`${t}.show.val`);return typeof n!="undefined"&&n!=="null"&&n!==""?e=JSON.parse(n):e=1,e},setConfigShow:function(t,e,n){this.setValueAckAsync(t,`${e}.show`,JSON.stringify(n))},toggleShow:function(t,e){let n=this.getConfigShow(e);n==null&&(n=0),n=n==1?0:1,this.setConfigShow(t,e,n)},getServerBroadcast:function(t,e,n,o){console.log(`getServerBroadcast request ${e}.${n}`),vis.conn.sendTo(t,"getServerBroadcast",{eventid:e,viewdate:n},function(i){i!="error"&&i!="nodata"?console.log(`getServerBroadcast received ok ${t}.${n}.${e}`):console.log(`getServerBroadcast received ${i}`),o&&o(i)}.bind(this))},getServerBroadcastAsync:function(t,e,n){return R(this,null,function*(){return console.log(`getServerBroadcast request ${e}.${n}`),yield this.sendToAsync(t,"getServerBroadcast",{eventid:e,viewdate:n})})},events:{},serverdata:{},getServerData:function(t,e,n,o){let i=t+n;Object.prototype.hasOwnProperty.call(this.serverdata,i)&&o(this.serverdata[i]),Object.prototype.hasOwnProperty.call(this.events,i)||(this.events[i]=[]);let a=this.events[i];a.find(l=>l.key==e)||a.push({key:e,cb:o}),vis.conn.sendTo(t,"getServerData",n,l=>{if(l!="error"&&l!="nodata"?console.log(`getServerData received ${t}.${n} ${JSON.stringify(l).substring(0,100)}`):console.log(`getServerData received err ${l}`),this.serverdata[i]=l,!Object.prototype.hasOwnProperty.call(this.events,i))return;let c=this.events[i];for(let h=0;h<c.length;h++)c[h].cb(l);delete this.events[i]})},getServerDataAsync:function(t,e,n){return R(this,null,function*(){console.log(`getServerData ${n}`);let o=t+n;return Object.prototype.hasOwnProperty.call(this.events,o)||(this.events[o]=[]),yield this.sendToAsync(t,"getServerData",n)})},getServerTVProgram:function(t,e,n,o){let i=`${t}program.${n}`;if(Object.prototype.hasOwnProperty.call(this.serverdata,i)&&o(this.serverdata[i]),Object.prototype.hasOwnProperty.call(this.events,i)){this.events[i].find(a=>a.key==e)||this.events[i].push({key:e,cb:o});return}this.events[i]=[{key:e,cb:o}],vis.conn.sendTo(t,"getServerTVProgram",n,function(a){if(a!="error"&&a!="nodata"?console.log(`getServerTVProgram received ${t}.${n}nodata`):(console.log(`getServerTVProgram received ${t}.${n} ok`),this.serverdata[i]=a),!!Object.prototype.hasOwnProperty.call(this.events,i)){for(let l=0;l<this.events[i].length;l++)this.events[i][l].cb(a);delete this.events[i]}}.bind(this))},getServerTVProgramAsync:function(t,e,n){return R(this,null,function*(){return console.log(`getServerTVProgram ${n}`),yield this.sendToAsync(t,"getServerTVProgram",n)})},getFavoritesData:function(t,e=[],n){console.log(`getFavoritesData request ${t}.favorites`),vis.conn.sendTo(t,"getFavoritesData",e,o=>{o!="error"&&o!="nodata"?console.log(`getFavoritesData received ok ${o.length}`):console.log(`getFavoritesData received ${t}.favorites`),n&&n(o)})},getFavoritesDataAsync:function(n){return R(this,arguments,function*(t,e=[]){return console.log(`getFavoritesData request ${t}.favorites`),yield this.sendToAsync(t,"getFavoritesData",e)})},getServerInfo:function(t,e){console.log("getServerInfo request "),vis.conn.sendTo(t,"getServerInfo",{},n=>{console.log("getServerInfo received ok "),e&&e(n)})},getServerInfoAsync:function(t){return R(this,null,function*(){return console.log("getServerInfo request "),yield this.sendToAsync(t,"getServerInfo",{})})},getServerBroadcastNow:function(t,e,n){console.log("getServerBroadcastNow request "),vis.conn.sendTo(t,"getServerBroadcastNow",e,function(o){o!="error"&&o!="nodata"?console.log(`getServerBroadcastNow received ok ${o.length}`):console.log("getServerBroadcastNow received "),n&&n(o)}.bind(this))},getServerBroadcastNowAsync:function(t,e){return R(this,null,function*(){return console.log("getServerBroadcastNow request "),yield this.sendToAsync(t,"getServerBroadcastNow",e)})},getServerBroadcastRangeAsync:function(t,e,n,o){return R(this,null,function*(){return console.log("getServerBroadcastRange request "),yield this.sendToAsync(t,"getServerBroadcastRange",{channelfilter:e,startdate:n,enddate:o})})},getServerBroadcastDate:function(t,e,n,o){console.log("getServerBroadcastDate request "),vis.conn.sendTo(t,"getServerBroadcastDate",{channelfilter:e,date:n},function(i){i!="error"&&i!="nodata"?console.log(`getServerBroadcastDate received ok ${i.length}`):console.error(`getServerBroadcastDate received ${i}`),o&&o(i)}.bind(this))},getServerBroadcastDateAsync:function(t,e,n){return R(this,null,function*(){return console.log("getServerBroadcastDate request "),yield this.sendToAsync(t,"getServerBroadcastDate",{channelfilter:e,date:n})})},getServerBroadcastFind:function(t,e,n){console.log("getServerBroadcastFind request "),vis.conn.sendTo(t,"getServerBroadcastFind",e,function(o){o!="error"&&o!="nodata"?console.log(`getServerBroadcastFind received ok ${o.length}`):console.log("getServerBroadcastFind received ");let i=[];o.map(a=>{a.events.map(l=>i.push(l))}),o=i.sort((a,l)=>new Date(a.startTime)-new Date(l.startTime)),n&&n(o)}.bind(this))},getServerBroadcastFindAsync:function(t,e){return R(this,null,function*(){console.log("getServerBroadcastFind request ");let n=yield this.sendToAsync(t,"getServerBroadcastFind",e),o=[];return n.map(i=>{i.events.map(a=>o.push(a))}),n=o.sort((i,a)=>new Date(i.startTime)-new Date(a.startTime)),n})},setValueAck:function(t,e,n){console.log("setValueAck request "),vis.conn.sendTo(t,"setValueAck",{id:e,value:n})},setValueAckAsync:function(t,e,n){return R(this,null,function*(){return console.log("setValueAck request "),yield this.sendToAsync(t,"setValueAck",{id:e,value:n})})},sendToAsync:function(t,e,n){return R(this,null,function*(){return console.log(`sendToAsync ${e} ${n}`),new Promise((o,i)=>{try{vis.conn.sendTo(t,e,n,function(a){o(a)})}catch(a){i(a)}})})},loadServerInfosAsync:function(t){return R(this,null,function*(){return this.infos=[],yield this.getServerInfoAsync(t)})},loadCategories:function(t,e){return R(this,null,function*(){return console.log("loadCategories"),yield this.getServerDataAsync(t,e,"categories")})},loadChannels:function(t,e){return R(this,null,function*(){return console.log("loadChannels"),yield this.getServerDataAsync(t,e,"channels")})},loadGenres:function(t,e){return R(this,null,function*(){return console.log("loadGenres"),yield this.getServerDataAsync(t,e,"genres")})},loadProgram:function(t,e,n){return R(this,null,function*(){return console.log(`loadProgram ${n}`),yield this.getServerTVProgramAsync(t,e,n)})},calcDate:function(t){let e=new Date(t),n=e.getHours()+e.getMinutes()/60;return n>=0&&n<5&&e.setDate(e.getDate()-1),e},getDate:function(t,e){let n=new Date(t);return n.setDate(n.getDate()+e),`${n.getFullYear()}-${`0${n.getMonth()+1}`.slice(-2)}-${`0${n.getDate()}`.slice(-2)}`},compareDate:function(t,e){return t.getDate()==e.getDate()&&t.getMonth()==e.getMonth()&&t.getYear()==e.getYear()},getTvprogramId:function(t){let e=t.split(".");return e.length<2?"":(e=e.slice(0,3),e.join("."))},getInstance:function(t){let e=t.split(".");return e.length<2?"":(e=e.slice(0,2),e.join("."))},getInstanceInfo:function(t){console.log("getInstanceInfo");let e=t.trim().split(".");return e.length<2?[null,null]:[e.slice(0,2).join("."),e.slice(0,3).join(".")]},bindStates:function(t,e,n){console.log("bindStates");let o=$(t),i=o.data("bound");if(i)for(let a=0;a<i.length;a++)vis.states.unbind(i[a],n);o.data("bound",null),o.data("bindHandler",null),vis.conn.gettingStates=0,vis.conn.getStates(e,function(a,l){vis.conn.subscribe(e);for(let c=0;c<e.length;c++)e[c]=`${e[c]}.val`,vis.states.bind(e[c],n);vis.binds.tvprogram.updateStates(l),o.data("bound",e),o.data("bindHandler",n)}.bind({change_callback:n}))},updateStates:function(t){for(let e in t){if(!Object.prototype.hasOwnProperty.call(t,e))continue;let n=t[e];try{if(vis.editMode)vis.states[`${e}.val`]=n.val,vis.states[`${e}.ts`]=n.ts,vis.states[`${e}.ack`]=n.ack,vis.states[`${e}.lc`]=n.lc,n.q!==void 0&&n.q!==null&&(vis.states[`${e}.q`]=n.q);else{let o={};o[`${e}.val`]=n.val,o[`${e}.ts`]=n.ts,o[`${e}.ack`]=n.ack,o[`${e}.lc`]=n.lc,n.q!==void 0&&n.q!==null&&(o[`${e}.q`]=n.q),vis.states.attr(o)}}catch(o){console.error(`Error: can't create states object for ${e}(${o})`)}}}};vis.binds.tvprogram.showVersion();jQuery.fn.mydelay=function(t,e){return t=jQuery.fx&&jQuery.fx.speeds[t]||t,e=e||"fx",this.queue(e,function(n,o){let i=window.setTimeout(n,t);o.stop=function(){window.clearTimeout(i)}})}});_n();})();
/*! Bundled license information:

sortablejs/modular/sortable.esm.js:
  (**!
   * Sortable 1.15.6
   * @author	RubaXa   <trash@rubaxa.org>
   * @author	owenm    <owen23355@gmail.com>
   * @license MIT
   *)
*/
//# sourceMappingURL=tvprogram-dist.js.map
